if (self.CavalryLogger) { CavalryLogger.start_js(["vlwMS"]); }

__d("ConversationNubAddTabSource",[],(function a(b,c,d,e,f,g){f.exports={NOTIFICATION:"notification",PAGE_REFRESH:"page_refresh",USER_PIN:"user_pin",UNSEEN_NOTIFICATION:"unseen_notification",UNKNOWN:"unknown"};}),null);
__d("MercuryAttachmentType",[],(function a(b,c,d,e,f,g){f.exports={ERROR:"error",FILE:"file",PHOTO:"photo",STICKER:"sticker",SHARE:"share",UNKNOWN:"unknown",VIDEO:"video",ANIMATED_IMAGE:"animated_image",EMOJI_LIKE:"emoji_like",GIFT:"gift",THIRDPARTYSTICKER:"third_party_sticker"};}),null);
__d("MercuryTimePassed",[],(function a(b,c,d,e,f,g){f.exports={TODAY:0,WEEK_AGO:1,MONTH_AGO:2,CURRENT_YEAR:3,OTHER_YEAR:4};}),null);
__d("MercuryTypeaheadConstants",[],(function a(b,c,d,e,f,g){f.exports={COMPOSER_FRIENDS_MAX:4,COMPOSER_FB4C_MAX:4,COMPOSER_NON_FRIENDS_MAX:2,COMPOSER_MESSENGER_ONLY_CONTACT_MAX:4,COMPOSER_SHOW_MORE_LIMIT:2,COMPOSER_THREADS_INITIAL_LIMIT:2,COMPOSER_CHATTAB_MAX:5,COMPOSER_PAGES_MAX:5,COMPOSER_WM_MAX:19,USER_TYPE:"user",PAGE_TYPE:"page",THREAD_TYPE:"thread",HEADER_TYPE:"header",SEARCH_TYPE:"search",FRIEND_TYPE:"friend",NON_FRIEND_TYPE:"non_friend",FB4C_TYPE:"fb4c",MEETING_ROOM_PAGE_TYPE:"meeting_room_page",COMMERCE_PAGE_TYPE:"commerce_page",INTERNAL_BOT_PAGE_TYPE:"internal_bot_page",GAME_TYPE:"game",WORKPLACE_BOT_CATEGORY_TYPE:"WORKPLACE_BOT",VALID_EMAIL:"^([A-Z0-9._\u0025+-]+\u0040((?!facebook\\.com))[A-Z0-9.-]+\\.[A-Z]{2,4}|(([A-Z._\u0025+-]+[A-Z0-9._\u0025+-]*)|([A-Z0-9._\u0025+-]+[A-Z._\u0025+-]+[A-Z0-9._\u0025+-]*))\u0040(?:facebook\\.com))$"};}),null);
__d("MessagingRealtimeConstants",[],(function a(b,c,d,e,f,g){f.exports={VIEWER_FBID:"realtime_viewer_fbid"};}),null);
__d("MessagingSourceEnum",[],(function a(b,c,d,e,f,g){f.exports={CHAT_ORCA:"source:chat:orca",CHAT_IPHONE:"source:chat:iphone",CHAT_JABBER:"source:chat:jabber",CHAT_MEEBO:"source:chat:meebo",CHAT_WEB:"source:chat:web",CHAT_TEST:"source:chat:test",CHAT_FORWARD_DIALOG:"source:chat:forward",CHAT:"source:chat",CONTACT_ADD_MUTATION:"source:contact_add:graphql_mutation",CONTACT_ADD_CYMK:"source:contact_add:cymk_suggestion",EMAIL:"source:email",EVENT_MESSAGE_BLAST:"source:event_message_blast",EVENT_REMINDERS:"source:event_reminders",FUNDRAISER_MESSAGE_BLAST:"source:fundraiser_message_blast",GENERIC_ADMIN_TEXT:"source:generic_admin_text",GIGABOXX_API:"source:gigaboxx:api",GIGABOXX_BLAST:"source:gigaboxx:blast",GIGABOXX_EMAIL_REPLY:"source:gigaboxx:emailreply",GIGABOXX_MOBILE:"source:gigaboxx:mobile",GIGABOXX_WAP:"source:gigaboxx:wap",GIGABOXX_WEB:"source:gigaboxx:web",INVITE:"source:invite",LEIA:"source:leia",MESSENGER_WEB:"source:messenger:web",MESSENGER_WEB_SEARCH:"source:messenger:web_search",SAM_UFI:"source:sam:ufi",SHARE_DIALOG:"source:share:dialog",SEND_PLUGIN:"source:sendplugin",SMS:"source:sms",TEST:"source:test",TITAN_WAP:"source:titan:wap",TITAN_M_BASIC:"source:titan:m_basic",TITAN_M_FREE:"source:titan:m_free_basic",TITAN_M_JAPAN:"source:titan:m_japan",TITAN_M_MINI:"source:titan:m_mini",TITAN_M_TOUCH:"source:titan:m_touch",TITAN_M_APP:"source:titan:m_app",TITAN_M_TABLET:"source:titan:m_tablet",TITAN_M_ZERO:"source:titan:m_zero",TITAN_M_TALK:"source:titan:m_talk",TITAN_WEB:"source:titan:web",TITAN_FACEWEB_ANDROID:"source:titan:faceweb_android",TITAN_FACEWEB_BUFFY:"source:titan:faceweb_buffy",TITAN_FACEWEB_IPAD:"source:titan:faceweb_ipad",TITAN_FACEWEB_IPHONE:"source:titan:faceweb_iphone",TITAN_FACEWEB_UNKNOWN:"source:titan:faceweb_unknown",TITAN_API:"source:titan:api",TITAN_API_MOBILE:"source:titan:api_mobile",TITAN_ORCA:"source:titan:orca",TITAN_EMAIL_REPLY:"source:titan:emailreply",MOBILE:"source:mobile",PAGE_PLATFORM_API:"source:page_platform_api",UNKNOWN:"source:unknown",WEB:"source:web",HELPCENTER:"source:helpcenter",NEW_SHARE_DIALOG:"source:share:dialog:new",PAID_PROMOTION:"source:paid_promotion",BUFFY_SMS:"source:buffy:sms",WEBRTC_MOBILE:"source:webrtc:mobile",MESSENGER_COMMERCE:"source:messenger:commerce",MESSENGER_BOT:"source:bot",MESSENGER_EMPLOYEE_ONLY_BOT:"source:bot:employee_only",MESSENGER_OMNIM:"source:messenger:omnim",PAGES_PRIVATE_REPLY:"source:pages:private_reply",MESSENGER_FORWARD_DIALOG:"source:messenger:forward",MESSENGER_AD:"source:messenger:ad",MARKETPLACE:"source:marketplace",MESSENGER_LEAD_GEN:"source:messenger:lead_gen",PAGES_MESSAGE_SHORTLINK:"source:pages:message_shortlink",STICKER_SUBSCRIBE:"source:messenger:sticker_subscribe",PHOTO_TAG:"source:messenger:photo_tag",INTERNAL_TEST_PENDING:"source:internal:test_pending",JOB_SEARCH_APPLICATION:"source:job_search:application",MESSENGER_JOINABLE_LINK:"source:messenger:joinable_link",MESSENGER_SMS_BRIDGE_CONVERT:"source:messenger:sms_bridge_conversion",TINCAN_ORCA:"source:tincan:orca",TINCAN_IOS:"source:tincan:ios",TINCAN_UNKNOWN:"source:tincan:unknown",FACEBOOK_GROUPS_CHANNELS:"source:groups:channels",GROUP_COMMERCE:"source:group_commerce",INTERNAL_TOOL:"source:internal:tool",PAGES_PLATFORM:"source:pages:platform",PAGES_RECOMMENDATION:"source:pages:recommendation",PAGE_AUTO_RESPONSE:"source:pages:auto_response",PAGES_INVITE:"source:pages:invite",FRIENDING_ADMIN_BUMP:"source:messenger_growth:friending_admin_bump",NEW_MESSENGER_USER_ADMIN_BUMP:"source:messenger_growth:new_messenger_user_admin_bump",EVENT_UPCOMING_BUMP:"source:messenger_growth:event_upcoming_bump"};}),null);
__d("StoryAttachmentStyle",[],(function a(b,c,d,e,f,g){f.exports={FALLBACK:"fallback",SHARE:"share",OG_COMPOSER_SIMPLE:"og_composer_simple",SPORTS_MATCHUP:"sports_matchup",SHARE_LARGE_IMAGE:"share_large_image",PHOTO:"photo",COVER_PHOTO:"cover_photo",INSPIRATION_PHOTO:"inspiration_photo",ALBUM:"album",NEW_ALBUM:"new_album",COUPON:"coupon",QUESTION:"question",ANSWER:"answer",OPTION:"option",GALLERY:"gallery",STREAM_PUBLISH:"stream_publish",MUSIC_AGGREGATION:"music_aggregation",ITEM_LIST:"list",HIGH_SCORE:"high_score",SCORE_LEADERBOARD:"score_leaderboard",FRIEND_LIST:"friend_list",POPULAR_OBJECTS:"popular_objects",AVATAR_LIST:"avatar_list",AVATAR:"avatar",AVATAR_WITH_VIDEO:"avatar_with_video",EVENT:"event",CANCELED_EVENT:"canceled_event",MINUTIAE_EVENT:"minutiae_event",EXPERIENCE:"experience",LIFE_EVENT:"life_event",GIFT:"gift",IMAGE_SHARE:"image_share",ANIMATED_IMAGE_SHARE:"animated_image_share",ANIMATED_IMAGE_AUTOPLAY:"animated_image_autoplay",ANIMATED_IMAGE_VIDEO:"animated_image_video",ANIMATED_IMAGE_VIDEO_AUTOPLAY:"animated_image_video_autoplay",NOTE:"note",TOPIC:"topic",TOPIC_FOLLOWING_TOPIC:"topic_following_topic",FILE_UPLOAD:"file_upload",NOTIFICATION_TARGET:"notification_target",UNAVAILABLE:"unavailable",PAGE_RECOMMENDATION:"page_recommendation",PAGE_VIDEO_PLAYLIST:"page_video_playlist",VIDEO:"video",VIDEO_INLINE:"video_inline",VIDEO_AUTOPLAY:"video_autoplay",VIDEO_SHARE:"video_share",VIDEO_SHARE_HIGHLIGHTED:"video_share_highlighted",VIDEO_SHARE_YOUTUBE:"video_share_youtube",VIDEO_DIRECT_RESPONSE:"video_direct_response",VIDEO_DIRECT_RESPONSE_AUTOPLAY:"video_direct_response_autoplay",VIDEO_SHOP:"video_shop",INSPIRATION_VIDEO:"inspiration_video",MULTI_VIDEOS_STITCHED:"multi_videos_stitched",MAP:"map",OG_MAP:"og_map",PRODUCT:"product",EXTERNAL_PRODUCT:"external_product",FITNESS_COURSE:"fitness_course",APPLICATION:"application",STICKER:"sticker",EXTERNAL_OG_PRODUCT:"external_og_product",TRAVEL_LOG:"travel_log",MULTI_SHARE:"multi_share",MULTI_SHARE_NO_END_CARD:"multi_share_no_end_card",MULTI_SHARE_NON_LINK_VIDEO:"multi_share_non_link_video",MULTI_SHARE_SEARCH_END_CARD:"multi_share_search_end_card",MULTI_SHARE_FIXED_TEXT:"multi_share_fixed_text",YEAR_IN_REVIEW:"year_in_review",AVATAR_LARGE_COVER:"avatar_large_cover",COMMERCE_PRODUCT_ITEM:"commerce_product_item",COMMERCE_STORE:"commerce_store",THIRD_PARTY_PHOTO:"third_party_photo",PROMPT:"prompt",BIRTHDAY:"birthday",BIRTHDAY_PERCEPTICONS:"birthday_percepticons",DISCUSSION_CONVERSATION:"discussion_conversation",DISCUSSION_COMMENT:"discussion_comment",GROUP_SELL_PRODUCT_ITEM:"group_sell_product_item",GROUP_SELL_PRODUCT_ITEM_MARK_AS_SOLD:"group_sell_mark_as_sold",GAMETIME:"gametime",GAMETIME_LEAGUE:"gametime_league",GAMETIME_PLAY:"gametime_play",GROUP_REPORTED_POST_QUEUE:"group_reported_post_queue",GROUP_PENDING_POST_QUEUE:"group_pending_post_queue",GROUP_JOIN_REQUEST_QUEUE:"group_join_request_queue",GREETING_CARD:"greeting_card",LEAD_GEN:"lead_gen",ATTACHED_STORY:"attached_story",POST_CHANNEL:"post_channel",TEXT_FOR_COLLAGE:"text_for_collage",SOUVENIR:"souvenir",SLIDESHOW:"slideshow",ORION:"orion",ORION_REQUEST:"orion_request",P2P_PAYMENT:"p2p_payment",INSTANT_ARTICLE:"instant_article",MOMENTS_APP_INVITATION:"moments_app_invitation",MOMENTS_APP_PHOTO_REQUEST:"moments_app_photo_request",RIDE_ORDERED:"ride_ordered",RIDE_RECEIPT:"ride_receipt",BUSINESS_MESSAGE_ITEMS:"business_message_items",RETAIL_CANCELLATION:"retail_cancellation",RETAIL_PROMOTION:"retail_promotion",RETAIL_ITEM:"retail_item",RETAIL_NOW_IN_STOCK:"retail_now_in_stock",RETAIL_RECEIPT:"retail_receipt",RETAIL_SHIPMENT:"retail_shipment",RETAIL_SHIPMENT_FOR_SUPPORTED_CARRIER:"retail_shipment_for_supported_carrier",RETAIL_SHIPMENT_FOR_UNSUPPORTED_CARRIER:"retail_shipment_for_unsupported_carrier",RETAIL_SHIPMENT_TRACKING_EVENT:"retail_shipment_tracking_event",RETAIL_SHIPMENT_TRACKING_EVENT_ETA:"retail_shipment_tracking_event_eta",RETAIL_SHIPMENT_TRACKING_EVENT_IN_TRANSIT:"retail_shipment_tracking_event_in_transit",RETAIL_SHIPMENT_TRACKING_EVENT_OUT_FOR_DELIVERY:"retail_shipment_tracking_event_out_for_delivery",RETAIL_SHIPMENT_TRACKING_EVENT_DELAYED:"retail_shipment_tracking_event_delayed",RETAIL_SHIPMENT_TRACKING_EVENT_DELIVERED:"retail_shipment_tracking_event_delivered",SURVEY:"survey",MESSAGE_LOCATION:"message_location",JOB_OFFER:"job_offer",GROUP_ADD_MEMBERS:"group_add_memebers",GROUP_MEMBER_ADDED:"group_member_added",RTC_CALL_LOG:"rtc_call_log",EVENTS_PENDING_POST_QUEUE:"events_pending_post_queue",EVENT_CALENDAR:"event_calendar",FACEPILE:"facepile",ATTRIBUTED_SHARE:"attributed_share",VIDEO_CINEMAGRAPH:"video_cinemagraph",LOCAL_CONTEXT_SHARE:"local_context_share",H_SCROLL:"h_scroll",EGO_HSCROLL:"ego_hscroll",MEDIA_QUESTION:"media_question",RICH_MEDIA:"rich_media",RICH_MEDIA_COLLECTION:"rich_media_collection",SQUARE_IMAGE_SHARE:"square_image_share",RETAIL_AGENT_ITEM_SUGGESTION:"retail_agent_item_suggestion",RETAIL_AGENT_ITEM_RECEIPT:"retail_agent_item_receipt",NOTE_COMPOSED:"note_composed",AVATAR_WITH_BIRTHDAY:"avatar_with_birthday",AIRLINE_FLIGHT_RESCHEDULE_UPDATE_BUBBLE:"airline_flight_reschedule_update_bubble",AIRLINE_CONFIRMATION:"airline_confirmation",AIRLINE_CHECK_IN:"airline_check_in",AIRLINE_BOARDING_PASS:"airline_boarding_pass",AIRLINE_FLIGHT_RESCHEDULE_UPDATE:"airline_flight_reschedule_update",LIGHTBOX_VIDEO:"lightbox_video",GLOBALLY_DELETED_MESSAGE_PLACEHOLDER:"globally_deleted_message_placeholder",GENIE_MESSAGE:"genie_message",MOVIE_BOT_MOVIE_LIST:"movie_bot_movie_list",MOVIE_BOT_MOVIE_SHOWTIME_LIST:"movie_bot_movie_showtime_list",AVATAR_WITH_EGO_ACTION:"avatar_with_ego_action",EVENT_TICKET_DEPRECATED:"event_ticket",VERTICAL_ATTACHMENT_LIST:"vertical_attachment_list",INSTANT_ARTICLE_LEGACY:"instant_article_legacy",FUNDRAISER_PAGE:"fundraiser_page",FINANCIAL_BILL_PAYMENT_REQUEST:"financial_bill_payment_request",GOODWILL_THROWBACK_FRIENDVERSARY_POLAROIDS_CARD:"goodwill_throwback_friendversary_polaroids_card",WELCOME_CARD_IMAGE:"welcome_card_image",LARGE_IMAGE_LIKE:"large_image_like",ASK_FRIENDS:"ask_friends",CULTURAL_MOMENT:"cultural_moment",TELEPHONE_CALL_LOG:"telephone_call_log",SUPER_EMOJI:"super_emoji",BOOK:"book",SUBTOPIC_CUSTOMIZATION_QUESTION:"subtopic_customization_question",SUBTOPIC_CUSTOMIZATION_OPTION:"subtopic_customization_option",RESTAURANT:"restaurant",CONNECTION_QUESTION:"connection_question",CONNECTION_QUESTION_OPTION:"connection_question_option",PYMI_ITEM:"pymi_item",GOODWILL_THROWBACK_FRIENDVERSARY_COLLAGE_CARD:"goodwill_throwback_friendversary_collage_card",CITY:"city",AVATAR_WITH_SHARE:"avatar_with_share",LIGHTWEIGHT_PLACE:"lightweight_place",QUOTED_SHARE:"quoted_share",SMS_LOG:"sms_log",CENTERED_TEXT:"centered_text",GOODWILL_THROWBACK_FRIENDVERSARY_DATA_CARD:"goodwill_throwback_friendversary_data_card",GOODWILL_THROWBACK_FACEVERSARY_COLLAGE_CARD:"goodwill_throwback_faceversary_collage_card",GOODWILL_THROWBACK_ANNIVERSARY_COLLAGE_CARD:"goodwill_throwback_anniversary_collage_card",MESSAGE_EVENT:"message_event",MESSAGE_THREAD:"message_thread",QUOTE:"quote",VOTER_REGISTRATION_SHARE:"voter_registration_share",AIRLINE_ITINERARY:"airline_itinerary",AIRLINE_UPDATE:"airline_update",PLACE_LIST:"place_list",IMPLICIT_PLACE_LIST_CONVERSION:"implicit_place_list_conversion",AIRLINE_CHECKIN_REMINDER:"airline_checkin_reminder",MINUTIAE_UNIT:"minutiae_unit",INSTANT_ARTICLE_PHOTO:"instant_article_photo",INSTANT_ARTICLE_VIDEO:"instant_article_video",PHOTO_LINK_SHARE:"photo_link_share",BUSINESS_LOCATION:"business_location",GOODWILL_WEATHER:"goodwill_weather",CULTURAL_MOMENT_HOLIDAY_CARD:"cultural_moment_holiday_card",TRANSACTION_INVOICE:"transaction_invoice",GROUP:"group",COMMENT_PLACE_INFO:"comment_place_info",GOODWILL_THROWBACK_FRIENDVERSARY_POLAROIDS_CARD_IPB:"goodwill_throwback_friendversary_polaroids_card_ipb",GOODWILL_THROWBACK_FRIENDVERSARY_COLLAGE_CARD_IPB:"goodwill_throwback_friendversary_collage_card_ipb",FUNDRAISER_PERSON_TO_CHARITY:"fundraiser_person_to_charity",FUNDRAISER_PERSON_FOR_PERSON:"fundraiser_person_for_person",FUNDRAISER_FOR_STORY:"fundraiser_for_story",MESSAGE_LIVE_LOCATION:"message_live_location",MESSENGER_INVITE:"messenger_invite",GAMES_INSTANT_PLAY:"games_instant_play",PROFILE_MEDIA:"profile_media",NATIVE_TEMPLATES:"native_templates",GOODWILL_THROWBACK_VIDEO_BASIC:"goodwill_throwback_video_basic",COMMERCE_PRODUCT_MINI:"commerce_product_mini",COMMERCE_PRODUCT_MINI_LIST:"commerce_product_mini_list",COMMENT:"comment",MESSENGER_TEAM_BOT_SHARE:"messenger_team_bot_share",LIVE_VIDEO_SCHEDULE:"live_video_schedule",PRODUCT_ITEM:"product_item",PLATFORM_INSTANT_APP:"platform_instant_app",YEAR_OVERVIEW:"year_overview",NATIVE_COMPONENT_FLOW_BOOKING_REQUEST:"native_component_flow_booking_request",FRIEND_REQUEST:"friend_request",MESSENGER_GROUP_JOINABLE_LINK:"messenger_group_joinable_link",SOCIAL_SEARCH_CONVERSION_PROMPT:"social_search_conversion_prompt",MDOTME_USER_LINK:"mdotme_user_link",DYNAMIC_MULTI_SHARE_ITEMS:"dynamic_multi_share_items",EVENT_REMINDER:"event_reminder",INSTANT_GAMES_SHARE_MESSAGE:"instant_games_share_message",MESSENGER_PLATFORM_COMPACT_ITEM:"messenger_platform_compact_item",MESSENGER_PLATFORM_COVER_ITEM:"messenger_platform_cover_item",MULTI_SHARE_NON_LINK_VIDEO_AUTO_SCROLL:"multi_share_non_link_video_auto_scroll",ENDORSEMENT:"endorsement",OFFER_VIEW_LIVE_COUNTDOWN:"offer_view_live_countdown",ENHANCED_LINK_REDDIT_POST:"enhanced_link_reddit_post",MESSENGER_COMMERCE_COVER_ITEM:"messenger_commerce_cover_item",ENHANCED_LINK_YELP_BUSINESS:"enhanced_link_yelp_business",PAGES_PLATFORM_LEAD_GEN:"pages_platform_lead_gen",NATIVE_STORY:"native_story",MFS_BILL_PAY_CREATION_UPDATE:"mfs_bill_pay_creation_update",MFS_BILL_PAY_REFERENCE_CODE_UPDATE:"mfs_bill_pay_reference_code_update",MFS_BILL_PAY_AGENT_CASH_IN_UPDATE:"mfs_bill_pay_agent_cash_in_update",ISSUE_POSITION:"issue_position",PAGES_PLATFORM_BOOKING_MESSAGE:"pages_platform_booking_message",EXTERNAL_GALLERY:"external_gallery",MEME_SHARE:"meme_share",MESSENGER_PLATFORM_ELEMENT:"messenger_platform_element",INSTANT_GAMES_SHARE_SCORE_MESSAGE:"instant_games_share_score_message",MESSENGER_PLATFORM_BUTTON_LIST:"messenger_platform_button_list",BALLOT:"ballot",LIGHTWEIGHT_ACTION:"lightweight_action",TAROT_DIGEST:"tarot_digest",EVENT_TOUR:"event_tour",ADAPTIVE_MEDIA:"adaptive_media",DYNAMIC_GAME_BOARD:"dynamic_game_board",PAYMENT_PLATFORM:"payment_platform",OMNI_M_FLOW:"omni_m_flow",GROUP_QUIZ:"group_quiz",TRIAL_AD:"trial_ad",TEEM_COLLECTIONS:"teem_collections",CRISIS_STATUS:"crisis_status",CRISIS_LISTING:"crisis_listing",VR_CONTENT:"vr_content",VIDEO_RECOMMENDATION_HSCROLL:"video_recommendation_hscroll",VIDEO_TRAILER:"video_trailer",SHOW_PAGE_SHARE:"show_page_share",MFS_ATTACHMENT:"mfs_attachment",GROUP_TASK:"group_task",VIDEO_RECOMMENDATION_SINGLETON:"video_recommendation_singleton",PAGE_REVIEW_PROMPT:"page_review_prompt",VIDEO_SHOW:"video_show",UNCONNECTED_VIDEO:"unconnected_video",SHOW_SHARE:"show_share",JOB_SEARCH_JOB_APPLICATION:"job_search_job_application",PAGE_MESSENGER_ATTACHMENT:"page_messenger_attachment",CONTACT_YOUR_REP:"contact_your_rep",LOCATION_EXTENSION:"location_extension",PLACE_RECOMMENDATION:"place_recommendation",JOB_SEARCH_JOB_OPENING:"job_search_job_opening",PAGE_MESSAGE_ONLINE_INDICATOR:"page_message_online_indicator",LOCAL_PIVOT:"local_pivot",ORION_REQUEST_NEW:"orion_request_new",PHOTO_WITH_SHIELD:"photo_with_shield",PLAYABLE_AD:"playable_ad",FUN_FACT_PROMPT:"fun_fact_prompt",FATIGUED_SHARE:"fatigued_share",DISCUSSION_QUESTION:"discussion_question",PARTIES_INVITE:"parties_invite",PROFILE_INTRO_CARD_BIO:"profile_intro_card_bio",PAGES_SHARE:"pages_share"};}),null);
__d("VideoPlayerOrigins",[],(function a(b,c,d,e,f,g){f.exports={NEWSFEED:"newsfeed",USER_TIMELINE:"user_timeline",PAGE_TIMELINE:"page_timeline",PERMALINK:"permalink",GROUP:"group",CONNECTED_TV:"connected_tv",CONNECTED_TV_DISCOVERY:"connected_tv_discovery",CONNECTED_TV_PLAYER:"connected_tv_player",CONNECTED_TV_PROFILE:"connected_tv_profile",VIDEO_HOME:"video_home",VIDEO_HOME_FEED:"video_home_feed",VIDEO_HOME_REACTION:"video_home_reaction",VIDEO_HOME_MAIN:"video_home_main",VIDEO_HOME_GUIDE:"video_home_guide",VIDEO_TAB:"video_tab",EXTERNAL:"external",INSTANT_ARTICLES:"instant_articles",INTERN:"intern",BACKSTAGE:"backstage",INSTANT_SHOPPING:"instant_shopping",REDSPACE:"redspace",SAVED:"saved",SEARCH:"search",NOTIFICATIONS:"notifications",UNKNOWN:"unknown",LIVE_CONTROL_PANEL:"live_control_panel",LIVE_MAP:"live_map",LIVE_REDIRECT:"live_redirect",LIVE_EMBED_REDIRECT:"live_embed_redirect",LOCAL_NEWS:"local_news",PAGES_MODULE:"pages_module",PAGES_VIDEO_TAB:"pages_video_tab",PROMOTIONS_MANAGER_INSPIRATION_GALLERY:"promotions_manager_inspiration_gallery",BACKGROUND_PLAY:"background_play",QUICK_PROMOTION:"quick_promotion",CULTURAL_MOMENTS:"cultural_moments_share",SPHERIAL_VIDEO_EDITING:"spherial_video_editing",EXPLORE_FEED:"explorefeed",RHC:"rhc",ADS:"ads",CANVAS:"canvas",COMMERCE:"commerce",COMPOSER:"composer",DASH:"dash",FACEWEB:"faceweb",FEEDBACK:"feedback",FRIENDS:"friends",EVENTS:"events",HELP:"help",INFRASTRUCTURE:"infrastructure",LOGIN:"login",MARKETING:"marketing",MESSAGING:"messaging",NAVIGATION:"navigation",PHOTOS:"photos",PRIVACY:"privacy",SETTINGS:"settings",STORY_VIEW:"story_view",WEBVIEW:"webview",TRENDING:"trending",FACECAST_NUX:"facecast_nux",PIXELCLOUD:"pixelcloud",TAROT:"tarot",GAMEROOM:"gameroom",LEARN:"learn",BEEPER:"beeper",FACECAST_BEEPER:"facecast_beeper",JOB_SEARCH:"job_search",TOP_LIVE_BOOKMARK:"top_live_bookmark"};}),null);
__d('AjaxRequest',['ErrorUtils','Keys','PHPQuerySerializer','TimeSlice','URI','UserAgent_DEPRECATED','ZeroRewrites','setTimeoutAcrossTransitions'],(function a(b,c,d,e,f,g){function h(l,m,n){if(!(m instanceof c('URI')))m=new (c('URI'))(m);this.xhr=c('ZeroRewrites').getTransportBuilderForURI(m)();if(n&&l=='GET'){m.setQueryData(n);}else this._params=n;this.method=l;this.uri=m;this.xhr.open(l,m);}var i=window.XMLHttpRequest&&'withCredentials' in new XMLHttpRequest();h.supportsCORS=function(){return i;};h.ERROR='ar:error';h.TIMEOUT='ar:timeout';h.PROXY_ERROR='ar:proxy error';h.TRANSPORT_ERROR='ar:transport error';h.SERVER_ERROR='ar:http error';h.PARSE_ERROR='ar:parse error';h.SERVICE_UNAVAILABLE='ar:noservice';h._inflight=[];function j(){var l=h._inflight;h._inflight=[];l.forEach(function(m){m.abort();});}function k(l){l.onJSON=l.onError=l.onSuccess=null;clearTimeout(l._timer);if(l.xhr&&l.xhr.readyState<4){l.xhr.abort();l.xhr=null;}h._inflight=h._inflight.filter(function(m){return m&&m!=l&&m.xhr&&m.xhr.readyState<4;});}Object.assign(h.prototype,{timeout:60000,streamMode:true,prelude:/^for \(;;\);/,status:null,_eol:-1,_call:function l(m){if(this[m])this[m](this);},_parseStatus:function l(){var m;try{this.status=this.xhr.status;m=this.xhr.statusText;}catch(n){if(this.xhr.readyState>=4){this.errorType=h.TRANSPORT_ERROR;this.errorText=n.message;}return;}if(this.status===0&&!/^(file|ftp)/.test(this.uri)){this.errorType=h.TRANSPORT_ERROR;}else if(this.status>=100&&this.status<200){this.errorType=h.PROXY_ERROR;}else if(this.status>=200&&this.status<300){return;}else if(this.status>=300&&this.status<400){this.errorType=h.PROXY_ERROR;}else if(this.status>=400&&this.status<500){this.errorType=h.SERVER_ERROR;}else if(this.status===503){this.errorType=h.SERVICE_UNAVAILABLE;}else if(this.status>500&&this.status<600){this.errorType=h.PROXY_ERROR;}else if(this.status==1223){return;}else if(this.status>=12001&&this.status<=12156){this.errorType=h.TRANSPORT_ERROR;}else{m='unrecognized status code: '+this.status;this.errorType=h.ERROR;}if(!this.errorText)this.errorText=m;},_parseResponse:function l(){var m,n=this.xhr.readyState;try{m=this.xhr.responseText||'';}catch(t){if(n>=4){this.errorType=h.ERROR;this.errorText='responseText not available - '+t.message;}return;}while(this.xhr){var o=this._eol+1,p=this.streamMode?m.indexOf('\n',o):m.length;if(p<0&&n==4)p=m.length;if(p<=this._eol)break;var q=m;if(this.streamMode)q=m.substr(o,p-o).replace(/^\s*|\s*$/g,'');if(o===0&&this.prelude)if(this.prelude.test(q)){q=q.replace(this.prelude,'');}this._eol=p;if(q){try{this.json=JSON.parse(q);}catch(t){var r=/(<body[\S\s]+?<\/body>)/i.test(m)&&RegExp.$1,s={message:t.message,'char':o,excerpt:(o===0&&r||q).substr(512)};this.errorType=h.PARSE_ERROR;this.errorText='parse error - '+JSON.stringify(s);return;}c('ErrorUtils').applyWithGuard(this._call,this,['onJSON']);}}},_onReadyState:function l(m,n){var o=this.xhr&&this.xhr.readyState||0;if(this.status==null&&o>=2)this._parseStatus();if(!this.errorType&&this.status!=null)if(o==3&&this.streamMode||o==4)m.call(this);if(this.errorType||o==4){this._time=Date.now()-this._sentAt;n.call(this,this._call,!this.errorType?'onSuccess':'onError');k(this);}},send:function l(m){var n=c('TimeSlice').getGuardedContinuation('AjaxRequest xhr.onreadystatechange',true),o=c('TimeSlice').guard(this._parseResponse.bind(this),'AjaxRequest xhr.parseResponse',{isContinuation:false});this.xhr.onreadystatechange=this._onReadyState.bind(this,o,n);var p=this.timeout;if(p)this._timer=c('setTimeoutAcrossTransitions')(function(){this.errorType=h.TIMEOUT;this.errorText='timeout';this._time=Date.now()-this._sentAt;this._call('onError');k(this);}.bind(this),p);h._inflight.push(this);if(this.method=='POST')this.xhr.setRequestHeader('Content-Type','application/x-www-form-urlencoded');this._sentAt=Date.now();this.xhr.send(m?c('PHPQuerySerializer').serialize(m):'');},abort:function l(){k(this);},toString:function l(){var m='[AjaxRequest readyState='+this.xhr.readyState;if(this.errorType)m+=' errorType='+this.errorType+' ('+this.errorText+')';return m+']';},toJSON:function l(){var m={json:this.json,status:this.status,errorType:this.errorType,errorText:this.errorText,time:this._time};if(this.errorType)m.uri=this.uri;for(var n in m)if(m[n]==null)delete m[n];return m;}});if(window.addEventListener&&c('UserAgent_DEPRECATED').firefox())window.addEventListener('keydown',function(event){if(event.keyCode===c('Keys').ESC)event.prevent();},false);if(window.attachEvent)window.attachEvent('onunload',j);f.exports=h;}),null);
__d('ChannelSubdomain',['Event','JSLogger','Run','LogHistory','setTimeoutAcrossTransitions','WebStorage'],(function a(b,c,d,e,f,g){var h=c('LogHistory').getInstance('channel'),i=c('JSLogger').create('channel'),j='channel_sub:',k=7,l=100*1000,m=null,n;function o(){var q=c('WebStorage').getLocalStorage();if(n){clearTimeout(n);n=null;}if(q&&m!=null)q.removeItem(j+m);m=null;}function p(q,r,s){var t,u=(q-1)*k;if(s){if(n)clearTimeout(n);m=n=null;}if(r==null)r=Math.floor(Math.random()*u);if(m==null){var v,w,x,y,z,aa,ba;(function(){var ca=c('WebStorage').getLocalStorage();if(ca){v=[];for(w=0;w<ca.length;w++){x=ca.key(w);if(x.indexOf(j)===0){y=parseInt(x.substr(j.length),10);v[y]=parseInt(ca.getItem(x),10);}}z=Date.now()-l;for(w=0;w<u;w++){aa=(w+r)%u;if(!v[aa]||v[aa]<z){m=aa;break;}}if(m!=null){ba=function da(){try{ca.setItem(j+m,Date.now());}catch(ea){h.warn('subdomain set failed',ea.message);}n=c('setTimeoutAcrossTransitions')(ba,l/2);};ba();}else{h.warn('no channel subdomain',v);i.error('subdomain_overflow');}if(typeof window.onpageshow!='undefined'){c('Event').listen(window,'pagehide',o);}else c('Run').onUnload(o);}else m=r;})();}return m==null?null:m%k;}f.exports={allocate:p,clear:o};}),null);
__d('ChatproxyClientErrorsTypedLogger',['Banzai','GeneratedLoggerUtils','nullthrows'],(function a(b,c,d,e,f,g){'use strict';function h(){this.clear();}h.prototype.log=function(){c('GeneratedLoggerUtils').log('logger:ChatproxyClientErrorsLoggerConfig',this.$ChatproxyClientErrorsTypedLogger1,c('Banzai').BASIC);};h.prototype.logVital=function(){c('GeneratedLoggerUtils').log('logger:ChatproxyClientErrorsLoggerConfig',this.$ChatproxyClientErrorsTypedLogger1,c('Banzai').VITAL);};h.prototype.clear=function(){this.$ChatproxyClientErrorsTypedLogger1={};return this;};h.prototype.updateData=function(j){this.$ChatproxyClientErrorsTypedLogger1=babelHelpers['extends']({},this.$ChatproxyClientErrorsTypedLogger1,j);return this;};h.prototype.setErrorMessage=function(j){this.$ChatproxyClientErrorsTypedLogger1.error_message=j;return this;};h.prototype.setErrorReason=function(j){this.$ChatproxyClientErrorsTypedLogger1.error_reason=j;return this;};h.prototype.setStatusCode=function(j){this.$ChatproxyClientErrorsTypedLogger1.status_code=j;return this;};h.prototype.setTopicPrefixes=function(j){this.$ChatproxyClientErrorsTypedLogger1.topic_prefixes=c('GeneratedLoggerUtils').serializeVector(j);return this;};h.prototype.setURL=function(j){this.$ChatproxyClientErrorsTypedLogger1.url=j;return this;};var i={error_message:true,error_reason:true,status_code:true,topic_prefixes:true,url:true};f.exports=h;}),null);
__d('DocRPC',['ErrorUtils'],(function a(b,c,d,e,f,g){var h={_apis:{},_dispatch:function i(j){var k;try{j=JSON.parse(j);}catch(m){throw new Error('DocRPC unparsable dispatch: "'+j+'"');}if(Object.prototype.hasOwnProperty.call(h._apis,j.api)){var l=h._apis[j.api];if(l[j.method])k=c('ErrorUtils').applyWithGuard(l[j.method],l,j.args);}if(k===undefined)k=null;return JSON.stringify(k);},publish:function i(j,k){h._apis[k]=j;},proxy:function i(j,k,l){var m={};l.forEach(function(n){m[n]=function(){var o={api:k,method:n,args:Array.prototype.slice.call(arguments)},p;try{if(j.closed)throw new Error('DocRPC window closed');p=j.DocRPC._dispatch(JSON.stringify(o));}catch(q){c('ErrorUtils').reportError(q);return;}if(typeof p=='string')try{p=JSON.parse(p);}catch(q){throw new Error('DocRPC '+k+'.'+n+' unparsable return: "'+p+'"');}return p;};});return m;}};f.exports=b.DocRPC=h;}),null);
__d('ChannelTransport',['AjaxRequest','ChannelConstants','DocRPC','LogHistory','TimeSlice','URI','bind','setTimeoutAcrossTransitions','BanzaiODS','ChatproxyClientErrorsTypedLogger'],(function a(b,c,d,e,f,g){var h=c('LogHistory').getInstance('channel');function i(v){var w=new (c('ChatproxyClientErrorsTypedLogger'))();w.setStatusCode(v.status);w.setErrorMessage(v.errorType);if(v.uri!==undefined)w.setURL(v.uri.getPath());w.log();}function j(){return (1048576*Math.random()|0).toString(36);}function k(v){return !isNaN(v)&&isFinite(v)&&0<=v&&v<=6;}function l(v,w){var x='';if(k(v.subdomain))x=v.subdomain+'-';var y=v.host;y=y===null||y===undefined?'edge-chat':v.host;var z=new (c('URI'))(w).setDomain(x+y+'.'+v.domain).setPort(v.port).setSecure(new (c('URI'))(window.location.href).isSecure());return z;}function m(v){var w={partition:v.partition,cb:j(),failure:v.pingFailuresOnSubdomain};if(v.sticky_token)w.sticky_token=v.sticky_token;if(v.sticky_pool)w.sticky_pool=v.sticky_pool;var x=l(v,'/p').setQueryData(w);h.log('start_p',{uri:x.toString()});var y=new (c('AjaxRequest'))('GET',x);if(c('AjaxRequest').supportsCORS())y.xhr.withCredentials=true;var z=function aa(ba){h.log('finish_p',{xhr:ba.toJSON?ba.toJSON():ba,subdomain:v.subdomain,fullHost:v.fullHost});};y.onError=function(aa){c('BanzaiODS').bumpEntityKey('ChannelTransport','sendP.error');i(y);z(aa);if(v.subdomain===null)return;if(k(v.subdomain)){v.pingFailuresOnSubdomain++;v.subdomain++;if(v.subdomain>6)v.subdomain=0;}};y.timeout=v.P_TIMEOUT;y.onSuccess=function(aa){c('BanzaiODS').bumpEntityKey('ChannelTransport','sendP.success');z(aa);};y.send();}function n(v,w,x){var y=new Image(),z=0,aa=function da(ea){y.abort();return ea?w():x();};y.onload=c('TimeSlice').guard(function(){h.log('ping_ok',{duration:Date.now()-z});c('BanzaiODS').bumpEntityKey('ChannelTransport','sendPing.success');aa(true);},'ChannelTransport image.onload');y.onerror=c('TimeSlice').guard(function(){m(v);c('BanzaiODS').bumpEntityKey('ChannelTransport','sendPing.error');i(y);aa(false);},'ChannelTransport image.onerror');var ba=c('setTimeoutAcrossTransitions')(y.onerror,10000);y.abort=function(){if(ba){clearTimeout(ba);ba=null;}y.onload=y.onerror=null;};var ca={partition:v.partition,cb:j()};if(v.sticky_token)ca.sticky_token=v.sticky_token;if(v.sticky_pool)ca.sticky_pool=v.sticky_pool;if(v.lastRequestErrorReason){ca.reason=v.lastRequestErrorReason;v.lastRequestErrorReason=null;}if(v.uid&&v.viewerUid){ca.uid=v.uid;ca.viewer_uid=v.viewerUid;}z=Date.now();y.src=l(v,'/ping').setQueryData(ca);return y;}function o(v,w){var x={channel:v.user_channel,partition:v.partition,clientid:v.sessionID,cb:j(),cap:0,uid:v.uid,viewer_uid:v.viewerUid};if(v.sticky_token)x.sticky_token=v.sticky_token;if(v.sticky_pool)x.sticky_pool=v.sticky_pool;if(v.profile)x.profile=v.profile;if(v.capabilities)x.cap=v.capabilities;x.id=w;var y=l(v,'/add_bud').setQueryData(x),z=new (c('AjaxRequest'))('GET',y);if(c('AjaxRequest').supportsCORS())z.xhr.withCredentials=true;z.onError=function(aa){c('BanzaiODS').bumpEntityKey('ChannelTransport','sendAdditionalBuddy.error');h.warn('add_buddy_error');i(z);};z.onSuccess=function(aa){c('BanzaiODS').bumpEntityKey('ChannelTransport','sendAdditionalBuddy.success');h.log('add_buddy_ok');};z.timeout=v.P_TIMEOUT;z.send();}function p(v){var w={channel:v.user_channel,partition:v.partition,clientid:v.sessionID,cb:j(),cap:0,uid:v.uid,viewer_uid:v.viewerUid};if(v.sticky_token)w.sticky_token=v.sticky_token;if(v.sticky_pool)w.sticky_pool=v.sticky_pool;if(v.is_offline||v.shouldSuppressPresence){w.state='offline';}else w.state='active';if(w.state===v.lastPresenceState)return;v.lastPresenceState=w.state;if(v.profile)w.profile=v.profile;if(v.capabilities)w.cap=v.capabilities;var x=l(v,'/active_ping').setQueryData(w),y=new (c('AjaxRequest'))('GET',x);if(c('AjaxRequest').supportsCORS())y.xhr.withCredentials=true;y.onError=function(z){c('BanzaiODS').bumpEntityKey('ChannelTransport','sendActivePing.error');h.warn('active_ping_error');i(y);};y.onSuccess=function(z){c('BanzaiODS').bumpEntityKey('ChannelTransport','sendActivePing.success');h.log('active_ping_ok');};y.timeout=v.P_TIMEOUT;y.send();}function q(v,w,x,y){var z=new Date(),aa=-1;if(v.userActive>0){aa=(z-v.userActive)/1000|0;if(aa<0)h.warn('idle_regression',{idleTime:aa,now:z.getTime(),userActive:v.userActive});}var ba={channel:v.user_channel,seq:v.seq,partition:v.partition,clientid:v.sessionID,cb:j(),idle:aa,qp:'y',cap:0};if(v.state.aiq)ba.aiq=v.state.aiq;if(v.ready)if(v.seqTurSentAt==-1||v.seqTurSentAt==v.seq){ba.tur=v.timeUntilReady;ba.qpmade=v.queueMade;v.seqTurSentAt=v.seq;}ba.pws=v.pws;if(v.sequenceId>0)ba.isq=v.sequenceId;ba.msgs_recv=v.estimatedReceived;if(v.uid&&v.viewerUid){ba.uid=v.uid;ba.viewer_uid=v.viewerUid;}if(v.sticky_token){ba.sticky_token=v.sticky_token;}else{ba.request_batch=1;if(v.msgr_region)ba.msgr_region=v.msgr_region;}if(v.sticky_pool)ba.sticky_pool=v.sticky_pool;if('trace_id' in v)ba.traceid=v.trace_id;if(v.is_offline||v.shouldSuppressPresence){ba.state='offline';}else if(v.userActive>0&&aa<60)ba.state='active';v.lastPresenceState=ba.state;if(v.streamingCapable){ba.mode='stream';ba.format='json';}if(v.profile)ba.profile=v.profile;if(v.capabilities)ba.cap=v.capabilities;var ca=l(v,'/pull').setQueryData(ba),da='GET',ea=new (c('AjaxRequest'))(da,ca);if(c('AjaxRequest').supportsCORS())ea.xhr.withCredentials=true;ea.timeout=v.streamingCapable?v.STREAMING_TIMEOUT:v.LONGPOLL_TIMEOUT;ea.onJSON=function(fa){c('BanzaiODS').bumpEntityKey('ChannelTransport','sendPull.json');w(fa);};ea.onSuccess=function(fa){c('BanzaiODS').bumpEntityKey('ChannelTransport','sendPull.success');x(fa);};ea.onError=function(){var fa=this.status==12002&&this._time>=v.MIN_12002_TIMEOUT||this.status==504&&this._time>=v.MIN_504_TIMEOUT,ga=fa?x:y;if(fa){c('BanzaiODS').bumpEntityKey('ChannelTransport','sendPull.success');}else{c('BanzaiODS').bumpEntityKey('ChannelTransport','sendPull.error');i(ea);}return ga&&ga.apply(this,arguments);};ea.send();v.inStreaming=v.streamingCapable;return ea;}function r(v){this.manager=v;this.init&&this.init();}function s(v){r.apply(this,arguments);}Object.assign(s.prototype,{logName:'CORS',enterState:function v(w,x){if(this._request){this._request.abort();this._request=null;}if(w=='init')c('setTimeoutAcrossTransitions')(c('bind')(this.manager,'exitState',{status:c('ChannelConstants').OK,stateId:x.stateId}),0);if(!/pull|ping/.test(w))return;var y=this.manager;if(w=='ping'){this._request=n(x,c('bind')(y,'exitState',{status:c('ChannelConstants').OK,stateId:x.stateId}),c('bind')(y,'exitState',{status:c('ChannelConstants').ERROR,stateId:x.stateId}));}else if(w=='pull')this._request=q(x,c('bind')(y,'_processTransportData',x.stateId),c('bind')(y,'exitState',{status:c('ChannelConstants').OK,stateId:x.stateId}),c('bind')(y,'exitState',{status:c('ChannelConstants').ERROR,stateId:x.stateId}));}});function t(v){h.log('iframe_init_constructor');r.apply(this,arguments);this._iframe=document.createElement('iframe');this._iframe.style.display='none';document.body.appendChild(this._iframe);c('DocRPC').publish(this,'outerTransport');}Object.assign(t.prototype,{logName:'iframe',_initIframe:function v(w){h.log('iframe_init_start');window.onchanneliframeready=function(){h.log('iframe_resources');return w.resources;};window.onchanneliframeloaded=function(){h.log('iframe_loaded');};if(w){this._iframeURI=l(w,w.path);if(w.resources){var x=this._iframeURI.getDomain();w.resources=w.resources.map(function(y){var z=new (c('URI'))(y);if(z.getPath().startsWith('/intern/rsrc.php')&&z.getQueryData().origin!==undefined)return z.addQueryData('origin',x).toString();return y;});}}else this._iframeURI='about:blank';this._iframeProxy=null;try{this._iframe.contentWindow.location.replace(this._iframeURI);h.log('iframe_uri_set');}catch(y){h.error('iframe_uri_set_error',y);this.exitState({status:c('ChannelConstants').ERROR,stateId:w.stateId},y+'');}},enterState:function v(w,x){if(w=='init'){this._initIframe(x);}else if(/idle|ping|pull/.test(w)){if(this._iframeProxy){this._iframeProxy.enterState.apply(this._iframeProxy,arguments);}else if(w!='idle')this.exitState({status:c('ChannelConstants').ERROR,stateId:x.stateId},'iframe not yet loaded');}else if(w=='shutdown')this._initIframe();},_processTransportData:function v(){this.manager._processTransportData.apply(this.manager,arguments);},exitState:function v(w){if(this.manager.state=='init'&&w.status==c('ChannelConstants').OK)this._iframeProxy=c('DocRPC').proxy(this._iframe.contentWindow,'innerTransport',['enterState'],(this._iframeURI+'').replace(/iframe.*/,''));if(/ping|pull/.test(this.manager.state)&&!this._iframeProxy)return;this.manager.exitState.apply(this.manager,arguments);}});function u(){this.init=this.init.bind(this);r.apply(this,arguments);}Object.assign(u.prototype,{logName:'iframe(inner)',init:function v(){c('DocRPC').publish(this,'innerTransport');try{var w=c('DocRPC').proxy(window.parent,'outerTransport',['_processTransportData','exitState'],top.DocRPC.origin);Object.assign(this,w);this.exitState({status:c('ChannelConstants').OK,stateId:1e+06});}catch(x){h.error('iframe_inner_init_error',x);}},enterState:function v(w,x){if(this._request){this._request.abort();this._request=null;}if(w=='ping'){this._request=n(x,c('bind')(this,'exitState',{status:c('ChannelConstants').OK,stateId:x.stateId}),c('bind')(this,'exitState',{status:c('ChannelConstants').ERROR,stateId:x.stateId}));}else if(w=='pull')this._request=q(x,c('bind')(this,'_processTransportData',x.stateId),c('bind')(this,'exitState',{status:c('ChannelConstants').OK,stateId:x.stateId}),c('bind')(this,'exitState',{status:c('ChannelConstants').ERROR,stateId:x.stateId}));}});f.exports={isSubdomain:k,getURI:l,Transport:r,CORSTransport:s,IframeTransport:t,IframeInnerTransport:u,sendActivePing:p,sendAdditionalBuddyRequest:o};}),null);
__d('MercuryLoggingHelper',[],(function a(b,c,d,e,f,g){function h(j){return Array.from(j).slice(0,6).join('');}var i={obfuscateThread:function j(k){var l=babelHelpers['extends']({},k);if(k&&k.snippet&&k.snippet.length>9)l.snippet=h(k.snippet)+'...';return l;},obfuscateMessage:function j(k){var l=babelHelpers['extends']({},k);if(k&&k.body&&k.body.length>9)l.body=h(k.body)+'...';return l;}};f.exports=i;}),null);
__d('ChannelTransportDataLogger',['Arbiter','JSLogger','MercuryLoggingHelper'],(function a(b,c,d,e,f,g){'use strict';var h=[],i=10,j=function l(m){return m.map(function(n){var o=n;if(n.message||n.delta&&n.delta.body){o=babelHelpers['extends']({},n);if(n.message)o.message=c('MercuryLoggingHelper').obfuscateMessage(n.message);if(n.delta&&n.delta.body)o.delta=c('MercuryLoggingHelper').obfuscateMessage(n.delta);}return o;});},k={log:function l(m){var n={t:m.t,seq:m.seq};if(m.ms)n.ms=j(m.ms);h.push(n);if(h.length>i)h.shift();}};c('Arbiter').subscribe(c('JSLogger').DUMP_EVENT,function(l,m){m.channelTransportLog=h;});f.exports=k;}),null);
__d('ChatProxyConnectionState',[],(function a(b,c,d,e,f,g){'use strict';function h(){this.auxiliaryIrisQueues={};this.aiq=null;}h.prototype.subscribeIrisQueue=function(i,j){this.auxiliaryIrisQueues[i]=j;this.updateCaches();};h.prototype.unsubscribeIrisQueue=function(i){delete this.auxiliaryIrisQueues[i];this.updateCaches();};h.prototype.updateCaches=function(){var i=[];for(var j in this.auxiliaryIrisQueues)if(Object.prototype.hasOwnProperty.call(this.auxiliaryIrisQueues,j)){i.push(j);i.push(this.auxiliaryIrisQueues[j]);}if(i.length===0){this.aiq=null;}else this.aiq=i.join(',');};f.exports=h;}),null);
__d('FBAjaxRequest',['AjaxRequest','getAsyncParams'],(function a(b,c,d,e,f,g){function h(i,j,k){k=babelHelpers['extends']({},c('getAsyncParams')(i),k);var l=new (c('AjaxRequest'))(i,j,k);l.streamMode=false;var m=l._call;l._call=function(n){if(n=='onJSON'&&this.json){if(this.json.error){this.errorType=c('AjaxRequest').SERVER_ERROR;this.errorText='AsyncResponse error: '+this.json.error;}this.json=this.json.payload;}m.apply(this,arguments);};l.ajaxReqSend=l.send;l.send=function(n){this.ajaxReqSend(babelHelpers['extends']({},n,k));};return l;}f.exports=h;}),null);
__d('FantailLogger',['FantailConfig'],(function a(b,c,d,e,f,g){var h=c('FantailConfig').FantailLogQueue,i={debug:function j(k,l){var m;for(var n=arguments.length,o=Array(n>2?n-2:0),p=2;p<n;p++)o[p-2]=arguments[p];h&&(m=h.get(k)).debug.apply(m,[l].concat(o));},info:function j(k,l){var m;for(var n=arguments.length,o=Array(n>2?n-2:0),p=2;p<n;p++)o[p-2]=arguments[p];h&&(m=h.get(k)).info.apply(m,[l].concat(o));},warn:function j(k,l){var m;for(var n=arguments.length,o=Array(n>2?n-2:0),p=2;p<n;p++)o[p-2]=arguments[p];h&&(m=h.get(k)).warn.apply(m,[l].concat(o));},error:function j(k,l){var m;for(var n=arguments.length,o=Array(n>2?n-2:0),p=2;p<n;p++)o[p-2]=arguments[p];h&&(m=h.get(k)).error.apply(m,[l].concat(o));}};f.exports=i;}),null);
__d("MovingStat",[],(function a(b,c,d,e,f,g){function h(i){i=i||60000;var j={t:new Date(),count:0,v:0},k=j,l=0,m=0;function n(){var o=new Date()-i;while(k&&k.next&&k.t<o){l-=k.v;m-=k.count;k=k.next;}}this.add=function(o){l+=o;m++;var p=new Date();if(p-j.t<1000){j.v+=o;j.count++;}else{j.next={t:p,v:o,count:1};j=j.next;n();}};this.tally=function(o){o=o||1000;n();return {sum:l,count:m,timeAverage:l*o/i};};}f.exports=h;}),null);
__d('RTISession',['invariant','URI','AjaxRequest','ErrorUtils','ChatproxyClientErrorsTypedLogger','BanzaiODS','Set'],(function a(b,c,d,e,f,g,h){'use strict';var i='.facebook.com';function j(k,l,m,n,o,p,q,r,s){k||h(0);n||h(0);o||h(0);this.domain=k;this.port=l;this.edgePoolName=m;this.stickyToken=n;this.loggedInId=o;this.accountId=p;this.clientProfile=q||'desktop';this.clientId=r;this.capabilities=s;}j.prototype.issueRequest=function(k,l,m,n,o){k||h(0);l||h(0);n||h(0);var p=this.domain.length-i.length,q=p>0&&this.domain.indexOf(i,p)!==-1,r=q?this.domain:this.domain+i,s=(1048576*Math.random()|0).toString(36),t={cb:s,sticky_token:this.stickyToken,uid:this.loggedInId,viewer_uid:this.accountId,sticky_pool:this.edgePoolName,profile:this.clientProfile,clientid:this.clientId,cap:this.capabilities};for(var u in t)!l[u]||h(0);Object.assign(t,l);var v=new (c('URI'))(k).setDomain(r).setPort(this.port).setSecure(new (c('URI'))(window.location.href).isSecure()).setQueryData(t),w=m?'POST':'GET',x=new (c('AjaxRequest'))(w,v);x.timeout=o?o*1000:30000;if(x.xhr)x.xhr.withCredentials=true;var y={};x.onSuccess=function(){c('BanzaiODS').bumpEntityKey('RTISession','request.success');};x.onJSON=function(){y.data=x.json;y.error=null;c('ErrorUtils').applyWithGuard(n,this,[y]);}.bind(this);x.onError=function(){var z=new (c('Set'))();if(m!==undefined&&m.subscriptions!==undefined)for(var aa=0;aa<m.subscriptions.length;aa++){var ba=m.subscriptions[aa].topic.split('/');ba.pop();z.add(ba.join('/'));}y.data=null;y.error=x.errorType||'error';c('BanzaiODS').bumpEntityKey('RTISession','request.error');this.logRequestFailure(x,z);c('ErrorUtils').applyWithGuard(n,this,[y]);}.bind(this);x.send(JSON.stringify(m));};j.prototype.logRequestFailure=function(k,l){var m=new (c('ChatproxyClientErrorsTypedLogger'))();m.setStatusCode(k.status);m.setErrorMessage(k.errorType);m.setTopicPrefixes(l);m.setURL(k.uri.getPath());m.log();};f.exports=j;}),null);
__d('ChannelManager',['errorCode','Promise','AjaxRequest','Arbiter','AsyncRequest','BanzaiODS','ChannelClientID','ChannelConstants','ChannelInitialData','ChannelSubdomain','ChannelTransport','ChannelTransportDataLogger','ChatVisibility','ChatReliabilityInstrumentation','DTSG','Env','FantailLogger','FBAjaxRequest','FBRTCSupport','ISB','JSLogger','LogHistory','MessagingRealtimeConstants','MovingStat','PresenceCookieManager','PresenceState','PresenceUtil','RTISession','SystemEvents','URI','UserActivity','ChatProxyConnectionState','emptyFunction','requestAnimationFrameAcrossTransitions','setIntervalAcrossTransitions','setTimeoutAcrossTransitions'],(function a(b,c,d,e,f,g,h){var i,j=c('JSLogger').create('channel'),k=c('LogHistory').getInstance('channel_manager'),l=null,m=c('emptyFunction'),n=new (c('Promise'))(function(z,aa){m=z;});function o(z){l=z;}var p={idle:{ok:'init!'},init:{ok:'pull!',error:'reconnect',sys_online:'init',sys_timetravel:'init'},pull:{ok:'pull!',error:'ping',error_missing:'pull',error_msg_type:'pull',refresh_0:'reconnect',refresh_110:'reconnect',refresh_111:'reconnect',refresh_112:'pull',refresh_113:'pull',refresh_117:'reconnect'},ping:{ok:'pull!',error:'ping',error_stale:'reconnect!'},reconnect:{ok:'init!',error:'reconnect',sys_online:'reconnect',sys_timetravel:'reconnect'},shutdown:{},_all:{error_max:'shutdown!',error_shutdown:'shutdown!',sys_owner:'reconnect',sys_nonowner:'idle!',sys_online:'ping',sys_offline:'idle!',sys_timetravel:'ping'}},q={state:new (c('ChatProxyConnectionState'))(),userActive:Date.now(),created:Date.now(),ready:false,seqTurSentAt:-1,queueMade:'',sequenceId:0,lastPresenceState:null,lastRequestErrorReason:null,seq:0,pingFailuresOnSubdomain:0,pws:'fresh',estimatedReceived:0,sessionID:c('ChannelClientID').getID(),capabilities:c('FBRTCSupport').getCapabilities(),streamingCapable:false,inStreaming:false,shouldSuppressPresence:c('PresenceState').shouldSuppress(),LONGPOLL_TIMEOUT:60000,STREAMING_TIMEOUT:60000,P_TIMEOUT:30000,IFRAME_LOAD_TIMEOUT:30000,MIN_RETRY_INTERVAL:5000,MAX_RETRY_INTERVAL:320000,MIN_12002_TIMEOUT:9000,MIN_504_TIMEOUT:20000,STALL_THRESHOLD:180000,JUMPSTART_THRESHOLD:90000,MIN_INIT_PROBE_DELAY:3000,INIT_PROBE_DELAY_RANDOMIZE_RANGE:12000,CHANNEL_PROXY_REPORTING_MIN_INTERVAL:10000,PROBE_DELAY:60000,PROBE_HEARTBEATS_INTERVAL_LOW:1000,PROBE_HEARTBEATS_INTERVAL_HIGH:5000,STREAMING_EXIT_STATE_ON_CONTINUE:false},r=1,s={},t=0;function u(){return c('AsyncRequest').lastSuccessTime?Math.round((Date.now()-c('AsyncRequest').lastSuccessTime)/1000):-1;}function v(){var z={};if(i.getConfig('host'))z[i.getConfig('user_channel')]=i.getConfig('seq',0);return z;}function w(){var z=Date.now(),aa=Date.now(),ba={total:0},ca='idle',da=false;c('SystemEvents').subscribe([c('SystemEvents').USER,c('SystemEvents').ONLINE,c('SystemEvents').TIME_TRAVEL],function(ga,ha){x(true);aa=null;i.lastPullTime=Date.now();var ia;switch(ga){case c('SystemEvents').USER:ia=c('SystemEvents').isPageOwner()?c('ChannelConstants').SYS_OWNER:c('ChannelConstants').SYS_NONOWNER;break;case c('SystemEvents').ONLINE:ia=ha?c('ChannelConstants').SYS_ONLINE:c('ChannelConstants').SYS_OFFLINE;break;case c('SystemEvents').TIME_TRAVEL:if(q.skipTimeTravel)return;if(0<ha){c('FantailLogger').warn(c('ChannelConstants').FANTAIL_SERVICE,'skipping time travel failure. %s',ha);return;}ia=c('ChannelConstants').SYS_TIMETRAVEL;break;}i.exitState({status:ia,stateId:r});});var ea=function ga(ha,ia){var ja=Date.now(),ka=null;if(ia){z=ja;ka=ia.nextState||ia.state;}else ka=ca;c('SystemEvents').checkTimeTravel();if(aa){var la=Math.round((ja-aa)/1000);if(la>0){ba[ca]=(ba[ca]||0)+la;ba.total+=la;}}ca=ka;aa=ja;if(!ha){ba.lastSuccessTime=u();ba.online=c('SystemEvents').isOnline();k.log('rollup',JSON.stringify(ba));}};c('Arbiter').subscribe(c('ChannelConstants').ON_ENTER_STATE,ea);c('setIntervalAcrossTransitions')(ea,60000);c('Arbiter').subscribe(c('JSLogger').DUMP_EVENT,function(ga,ha){ha.channelRollup=ba;});var fa=function ga(){if(i.isShutdown()||i.shouldIdle())return;c('SystemEvents').checkTimeTravel();var ha=Date.now()-(i.lastPullTime||c('Env').start);if(!da&&ha>q.STALL_THRESHOLD){var ia=u();k.error('stall',JSON.stringify({lastSuccessTime:ia,rollupState:ca}));c('ChatReliabilityInstrumentation').logCHANNEL_STALLED(ha.toString());da=true;}var ja=Date.now()-z;if(i.state=='pull'&&ja>q.JUMPSTART_THRESHOLD){z=null;k.warn('jumpstart',JSON.stringify({state:i.state,dormant:ja}));i.enterState('init');}};c('setIntervalAcrossTransitions')(fa,5000);}function x(z){if(z){t=0;s={};}else t++;}function y(z,aa){var ba=!c('AjaxRequest').supportsCORS();if(!Object.prototype.hasOwnProperty.call(q,'host'))c('ChatReliabilityInstrumentation').logERROR('channel: no host in config');var ca=c('ChannelTransport').isSubdomain(q.subdomain);if(!ca||ba){q.fullHost=q.host;}else q.fullHost=q.subdomain+'-'+q.host;c('FantailLogger').info(c('ChannelConstants').FANTAIL_SERVICE,'received lb info: %s at seq: %s{%s} with '.concat('sticky: %s/%s, subdomain: %s, fullHost: %s, state: %s,').concat(' source: %s, args: %s'),q.sessionID,q.seq,q.sequenceId,q.sticky_token,q.sticky_pool,q.subdomain,q.fullHost,i.state,z,aa);}i={state:'idle',nextState:null,proxyDown:false,lastPullTime:Date.now(),lastReportOnMisguidedMsgTime:Date.now(),heartbeats:[],setTestCallback:o,backoff:false,sessionRegistered:false,init:function z(aa,ba){c('FantailLogger').info(c('ChannelConstants').FANTAIL_SERVICE,'initializing sessionid:%s at iris-seq:%s',q.sessionID,q.sequenceId);this.init=c('emptyFunction');c('Arbiter').subscribe(c('ChannelConstants').GET_RTI_SESSION_REQUEST,function(event,fa){this.informCurrentSession();}.bind(this));c('requestAnimationFrameAcrossTransitions')(function(){c('FantailLogger').info(c('ChannelConstants').FANTAIL_SERVICE,'using session id: %s at seq: %s {%s} with sticky: %s/%s',q.sessionID,q.seq,q.sequenceId,q.sticky_token,q.sticky_pool);c('UserActivity').subscribe(function(){var fa=c('ChannelTransport').getURI(q,'/U');c('FantailLogger').info(c('ChannelConstants').FANTAIL_SERVICE,'user activity sessionid: %s at seq: %s/{%s} '+'with sticky: %s/%s state: %s uri:%s',q.sessionID,q.seq,q.sequenceId,q.sticky_token,q.sticky_pool,i.state,fa);if(i.state=='pull'){q.userActive=Date.now();c('ChannelTransport').sendActivePing(q);}});});c('PresenceCookieManager').register('ch',v);var ca=this.getConfig('max_conn',2);q.subdomain=c('ChannelSubdomain').allocate(ca);if(!c('ChannelTransport').isSubdomain(q.subdomain)){c('FantailLogger').info(c('ChannelConstants').FANTAIL_SERVICE,'invalid subdomain from ChannelSubdomain: %s',q.subdomain);q.subdomain=null;}this._transportRate=new (c('MovingStat'))(30000);var da=c('AjaxRequest').supportsCORS()?'CORSTransport':'IframeTransport';this.transport=new (c('ChannelTransport')[da])(this);m(this.transport);if(aa)this.enterState(aa,ba);c('requestAnimationFrameAcrossTransitions')(function(){c('Arbiter').subscribe(c('JSLogger').DUMP_EVENT,function(event,fa){if(this._transportRate){fa.transportRate=this._transportRate.tally();fa.transportType=da;fa.transportVersion=2;}}.bind(this));w();}.bind(this));if(i.getConfig('tryStreaming')&&i.getConfig('fullHost')&&c('AjaxRequest').supportsCORS()){var ea=q.MIN_INIT_PROBE_DELAY+Math.random()*q.INIT_PROBE_DELAY_RANDOMIZE_RANGE;c('setTimeoutAcrossTransitions')(this._probeTest,ea);}},configure:function z(){for(var aa=arguments.length,ba=Array(aa),ca=0;ca<aa;ca++)ba[ca]=arguments[ca];k.log('configure',JSON.stringify(ba));ba.forEach(function(da){return Object.assign(q,da);});y('reconnect',JSON.stringify(ba));c('Arbiter').inform(c('ChannelConstants').ON_CONFIG,this);},getConfig:function z(aa,ba){return Object.prototype.hasOwnProperty.call(q,aa)?q[aa]:ba;},getCompleteConfig:function z(){return q;},subscribeIrisQueue:function z(aa,ba){q.state.subscribeIrisQueue(aa,ba);this.exitState({status:c('ChannelConstants').OK,stateId:r});},unsubscribeIrisQueue:function z(aa){q.state.unsubscribeIrisQueue(aa);},informCurrentSession:function z(){var aa=null;if(this.sessionRegistered&&q&&q.fullHost&&q.sticky_token&&q.uid)aa=new (c('RTISession'))(q.fullHost,q.port,q.sticky_pool,q.sticky_token,q.uid,q.viewerUid,q.profile,q.sessionID,q.capabilities);c('Arbiter').inform(c('ChannelConstants').RTI_SESSION,aa);},isShutdown:function z(){return this.state=='shutdown';},shouldIdle:function z(){return !(c('SystemEvents').isPageOwner()&&c('SystemEvents').isOnline());},_sendIframeError:function z(aa){var ba=new (c('AsyncRequest'))().setURI('/ajax/presence/reconnect.php').setData({reason:aa,fb_dtsg:c('DTSG').getToken()}).setOption('suppressErrorHandlerWarning',true).setOption('retries',1).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true);ba.specifiesWriteRequiredParams()&&ba.send();},_getDelay:function z(){var aa=Math.min(q.MIN_RETRY_INTERVAL*Math.pow(2,Math.max(0,t-1)),q.MAX_RETRY_INTERVAL);if(this.proxyDown&&'proxy_down_delay_millis' in q)aa=q.proxy_down_delay_millis;this.proxyDown=false;return Math.floor(aa*(1+Math.random()*.5));},resetDelay:function z(){x(true);},enterState:function z(){if(this._inEnterState){k.warn('enterstate_recursion',JSON.stringify({state:this.state,args:arguments}));c('ChatReliabilityInstrumentation').logERROR('enterstate_recursion');}this._inEnterState=true;try{this._enterState.apply(this,arguments);this._inEnterState=false;}catch(aa){this._inEnterState=false;throw aa;}},_enterState:function z(aa){var ba=this.backoff?this._getDelay():0;this.backoff=false;if(this.isShutdown()){c('FantailLogger').warn(c('ChannelConstants').FANTAIL_SERVICE,'not executing state due to shutdown mode: %s',aa);return;}if(aa!='idle!'&&this.shouldIdle()){c('FantailLogger').warn(c('ChannelConstants').FANTAIL_SERVICE,'forced idleness');return;}r++;q.stateId=r;clearTimeout(this._deferredTransition);this._deferredTransition=null;if(!this.transport){n.done(function(ha){return ha.enterState('idle');});c('ChatReliabilityInstrumentation').logERROR('called enterState '+aa+' before transport init');}else this.transport.enterState('idle');this.state='idle';this.nextState=null;if(/!$/.test(aa)){if(this._transportRate){var ca=this._transportRate.tally().timeAverage,da=i.getConfig('MAX_CHANNEL_STATES_PER_SEC',1);if(ca>=da){if(!this._throttled){this._throttled=true;k.warn('throttled','{}');}j.bump('throttle');ba=1000/da;}}}else if(!/#$/.test(aa))ba=this._getDelay();aa=aa.replace(/\W*$/,'');if(!p[aa]){c('FantailLogger').error(c('ChannelConstants').FANTAIL_SERVICE,'invalid state: %s',aa);throw new Error('invalid state:'+aa);}var ea=Array.from(arguments),fa;if(ba<=0){fa={state:aa};if(this._transportRate)this._transportRate.add(1);this.state=aa;var ga=this['_enter_'+this.state];if(ga){ea.shift();ga.apply(this,ea);}if(/init|idle|pull|ping/.test(this.state)){if(q.streamingCapable&&/pull/.test(this.state))this.heartbeats=[];q.is_offline=!c('ChatVisibility').isOnline();q.capabilities=c('FBRTCSupport').getCapabilities();c('FantailLogger').info(c('ChannelConstants').FANTAIL_SERVICE,'entering transport state: %s',this.state);if(!this.transport){n.done(function(ha){return ha.enterState(this.state,q);}.bind(this));c('ChatReliabilityInstrumentation').logERROR('called enterState '+aa+' before transport init');}else this.transport.enterState(this.state,q);if(this.state=='ping'){fa.url=c('ChannelTransport').getURI(q).toString();fa.port=q.port||'undefined';}}}else{this.state='idle';this.nextState=aa;fa={state:this.state,delay:ba,nextState:aa};ea[0]=aa+'#';this._deferredTransition=c('setTimeoutAcrossTransitions')(function(){this._deferredTransition=null;this.enterState.apply(this,ea);}.bind(this),ba);}if(/pull/.test(aa)){fa.client_id=q.sessionID;fa.streaming=q.inStreaming;}c('Arbiter').inform(c('ChannelConstants').ON_ENTER_STATE,fa);},exitState:function z(aa,ba){var ca=aa.stateId,da=aa.status;if(this.isShutdown()||ca<r)return;var ea=this.state,fa=Array.from(arguments);fa[0]=aa.status;var ga={state:ea,status:da};if(/pull/.test(ea)){ga.client_id=q.sessionID;ga.streaming=q.inStreaming;}if(/ping/.test(ea)&&da!=c('ChannelConstants').OK)ga.url=c('ChannelTransport').getURI(q).toString();if(this.nextState)ga.nextState=this.nextState;if(ba&&ba.errorType){q.lastRequestErrorReason=ba.errorType;ga.xhr=ba.toJSON?ba.toJSON():ba;if(ba.errorType==c('AjaxRequest').SERVICE_UNAVAILABLE){c('FantailLogger').error(c('ChannelConstants').FANTAIL_SERVICE,'got 5xx http status code, setting long delay');this.proxyDown=true;}delete ga.xhr.json;}else if(da!=c('ChannelConstants').OK)q.lastRequestErrorReason=da;if(ba&&ba.json){if(ba.json.t)ga.t=ba.json.t;if(ba.json.reason)ga.reason=ba.json.reason;if(ba.json.seq)ga.seq=ba.json.seq;}c('Arbiter').inform(c('ChannelConstants').ON_EXIT_STATE,ga);var ha=this['_exit_'+ea];if(ha)da=ha.apply(this,fa)||da;if(da!=c('ChannelConstants').OK){x();s[ea]=(s[ea]||0)+1;}var ia=p[this.nextState||ea][da]||p._all[da],ja=ia&&ia.replace(/!*$/,'');if(!ja){k.error('terminal_transition',JSON.stringify(ga));this._shutdownHint=c('ChannelConstants').HINT_INVALID_STATE;ia='shutdown!';c('FantailLogger').error(c('ChannelConstants').FANTAIL_SERVICE,'entering shutdown state');}this._lastState=ea;this._lastStatus=da;this.enterState(ia);},_processTransportData:function z(aa,ba){this._processTransportData0(aa,ba,ba.json);},_processTransportData0:function z(aa,ba,ca){var da=ca.t;if('s' in ca){ca.seq=ca.s;delete ca.s;}if(ca.u&&q.user&&ca.u!=q.user){k.warn('misguided_msg',JSON.stringify({user:q.user,target:ca.u}));this._reportProxyMisguidedMsg(ca.u,q.user);return;}c('ChannelTransportDataLogger').log(ca);var ea=q.seq;if('seq' in ca){q.seq=ca.seq;c('PresenceState').doSync();}switch(da){case 'continue':if(q.inStreaming&&this.heartbeats.length<1){q.streamingCapable=false;k.log('switch_to_longpoll','{}');c('setTimeoutAcrossTransitions')(this._probeTest,q.PROBE_DELAY);}x(true);if(!q.inStreaming||q.STREAMING_EXIT_STATE_ON_CONTINUE)this.exitState({status:c('ChannelConstants').OK,stateId:aa});break;case 'refresh':case 'refreshDelay':c('FantailLogger').info(c('ChannelConstants').FANTAIL_SERVICE,'got refresh with reason: %s',ca.reason);this.exitState({status:'refresh_'+(ca.reason||0),stateId:aa},ba);break;case 'backoff':c('FantailLogger').warn(c('ChannelConstants').FANTAIL_SERVICE,'server told client to back off');x();this.backoff=true;break;case 'lb':var fa=ca.lb_info;if(fa){q.sticky_token=fa.sticky;if('pool' in fa)q.sticky_pool=fa.pool;if('sd' in fa){var ga=fa.subdomain;if(c('ChannelTransport').isSubdomain(ga))q.subdomain=fa.subdomain;}if('vip' in fa)q.host=fa.vip;y('chatproxy',JSON.stringify(ca));}else k.error('missing_lb_info','{}');break;case 'test_streaming':c('setTimeoutAcrossTransitions')(this._probeTest,500);break;case 'fullReload':c('PresenceCookieManager').clear();k.log('full_reload','{}');this.sessionRegistered=true;this.informCurrentSession();c('Arbiter').inform(c('ChannelConstants').ON_INVALID_HISTORY);x(true);c('FantailLogger').info(c('ChannelConstants').FANTAIL_SERVICE,'full reload incurred');var ha=c('ChannelConstants').OK;this.exitState({status:ha,stateId:aa},ba);if('ms' in ca)this._processMessages(ca,ea);break;case 'msg':x(true);this._processMessages(ca,ea);break;case 'heartbeat':if(q.inStreaming){var ia=Date.now();if(this.heartbeats.length>0)var ja=ia-this.heartbeats[this.heartbeats.length-1];k.log('heartbeat_interval',JSON.stringify({client_id:q.sessionID,interval:ja}));this.heartbeats.push(ia);}break;case 'batched':var ka=ca.batches,la;for(la=0;la<ka.length;la++)this._processTransportData0(aa,ba,ka[la]);break;default:c('FantailLogger').error(c('ChannelConstants').FANTAIL_SERVICE,'got an unknown protocol message: %s',da);k.error('unknown_msg_type',JSON.stringify({type:da}));break;}},_processMessages:function z(aa,ba){var ca,da,ea,fa;if('tr' in aa)q.trace_id=aa.tr;da=aa.ms;ea=q.seq-da.length;for(ca=0;ca<da.length;ca++,ea++){q.estimatedReceived++;if(ea>=ba){fa=da[ca];if(fa.type){var ga=c('ChannelConstants').getArbiterType(fa.type);if(fa.type==='messaging'){var ha={type:'messaging',event:fa.event};if(fa.message){ha.inbox_unread=fa.unread_counts&&fa.unread_counts.inbox;ha.tid=fa.message.tid;ha.mid=fa.message.mid;c('FantailLogger').info(c('ChannelConstants').FANTAIL_SERVICE,'got message with id: %s',fa.message.mid);}}else if(fa.type==='skywalker'){ga=c('ChannelConstants').SKYWALKER;}else if(fa.type==='qprimer'){fa.first=!q.ready;if(fa.first){q.ready=true;q.timeUntilReady=Date.now()-q.created;q.queueMade=fa.made;}ga=c('ChannelConstants').CHANNEL_ESTABLISHED;}else if(fa.type==='pws'){q.pws=fa.pws;}else if(fa.type==='delta')q.sequenceId=fa.iseq;try{c('Arbiter').inform(ga,{obj:fa});}catch(ia){c('BanzaiODS').bumpEntityKey('ChannelManager','processMessages.error.'+fa.type);c('FantailLogger').info(c('ChannelConstants').FANTAIL_SERVICE,'message threw exception: %s %s',ia,fa);}}}else k.warn('seq_regression',JSON.stringify({last_seq:ba,messages:da.length,seq:ea}));}},_enter_init:function z(){if(s.init>=i.getConfig('MAX_INIT_FAILS',2))return c('setTimeoutAcrossTransitions')(function(){return this.exitState({status:c('ChannelConstants').ERROR_MAX,stateId:r});}.bind(this),0);this._initTimer=c('setTimeoutAcrossTransitions')(function(){return this.exitState({status:c('ChannelConstants').ERROR,stateId:r},'timeout');}.bind(this),q.IFRAME_LOAD_TIMEOUT);},_enter_reconnect:function z(aa){k.warn('enter_reconnect',aa);c('FantailLogger').info(c('ChannelConstants').FANTAIL_SERVICE,'entered reconnect with reason: %s',aa);var ba=r;if(!c('PresenceUtil').hasUserCookie()){c('FantailLogger').warn(c('ChannelConstants').FANTAIL_SERVICE,'user has no cookie???');k.warn('no_user_cookie','{}');c('setTimeoutAcrossTransitions')(function(){this._shutdownHint=c('ChannelConstants').HINT_AUTH;this.exitState({status:c('ChannelConstants').ERROR_SHUTDOWN,stateId:ba});}.bind(this),0);return;}var ca={reason:aa,fb_dtsg:c('DTSG').getToken()};if(c('ISB').token)ca.fb_isb=c('ISB').token;if(l)l(ca);var da=new (c('FBAjaxRequest'))('GET','/ajax/presence/reconnect.php',ca);da.onSuccess=function(){i.configure(da.json);c('PresenceCookieManager').store();this.exitState({status:c('ChannelConstants').OK,stateId:ba});}.bind(this);da.onError=function(){var ea=da.json&&da.json.error;c('FantailLogger').error(c('ChannelConstants').FANTAIL_SERVICE,'reconnect error: %s',da.errorType);if(da.errorType==c('AjaxRequest').TRANSPORT_ERROR||da.errorType==c('AjaxRequest').PROXY_ERROR||da.errorType==c('AjaxRequest').SERVICE_UNAVAILABLE)this._shutdownHint=c('ChannelConstants').HINT_CONN;if(ea&&ea==1356007){this._shutdownHint=c('ChannelConstants').HINT_MAINT;}else if(ea==1357001||ea==1357004||ea==1348009){this._shutdownHint=c('ChannelConstants').HINT_AUTH;}else this._shutdownHint=null;this.exitState({status:this._shutdownHint?c('ChannelConstants').ERROR_SHUTDOWN:c('ChannelConstants').ERROR,stateId:ba},da);}.bind(this);da.send();},_enter_shutdown:function z(){c('Arbiter').inform(c('ChannelConstants').ON_SHUTDOWN,{reason:this._shutdownHint});if('shutdown_recovery_interval_seconds' in q&&q.shutdown_recovery_interval_seconds>0){var aa=q.shutdown_recovery_interval_seconds*1000;c('setTimeoutAcrossTransitions')(function(){c('Arbiter').inform(c('ChannelConstants').ATTEMPT_RECONNECT);this._shutdownHint=null;this.state='reconnect!';this.enterState('reconnect!');}.bind(this),aa);}},_exit_init:function z(aa){if(this._initTimer)this._initTimer=clearTimeout(this._initTimer);if(aa==c('ChannelConstants').ERROR_MAX)this._sendIframeError(c('ChannelConstants').reason_IFrameLoadGiveUp);},_exit_pull:function z(aa,ba){var ca=aa==c('ChannelConstants').OK;if(ca){this.lastPullTime=Date.now();}else{var da='exit status: '+aa;if(ba&&ba.errorType)da+=' ajax request error: '+ba.errorType;c('FantailLogger').error(c('ChannelConstants').FANTAIL_SERVICE,'pull failed with status: %s',da);}},_exit_ping:function z(aa){if(aa==c('ChannelConstants').OK){var ba=Date.now()-(this.lastPullTime||c('Env').start);if(ba>q.STALL_THRESHOLD){c('FantailLogger').error(c('ChannelConstants').FANTAIL_SERVICE,'didnt complete a successful pull for too long');return c('ChannelConstants').ERROR_STALE;}}else c('FantailLogger').error(c('ChannelConstants').FANTAIL_SERVICE,'ping failed with status: %s',aa);},_reportProxyMisguidedMsg:function z(aa,ba){c('FantailLogger').error(c('ChannelConstants').FANTAIL_SERVICE,'misguided message to %s meant for %s',ba,aa);var ca=Date.now();if(ca-this.lastReportOnMisguidedMsgTime<=q.CHANNEL_PROXY_REPORTING_MIN_INTERVAL)return;this.lastReportOnMisguidedMsgTime=ca;var da={received_uid:aa,expected_uid:ba};if(q.sticky_token)da.sticky_token=q.sticky_token;var ea=new (c('URI'))('/err_misguided_msg').setDomain(q.host+'.'+q.domain).setPort(q.port).setSecure(new (c('URI'))(window.location.href).isSecure()).setQueryData(da),fa=new (c('AjaxRequest'))('GET',ea);if(c('AjaxRequest').supportsCORS())fa.xhr.withCredentials=true;fa.onSuccess=function(ga){};fa.onError=function(ga){};fa.onJSON=function(ga,ha){};fa.send();},_probeTest:function z(){q.streamingCapable=false;var aa=[],ba={mode:'stream',format:'json'};if(q.sticky_token)ba.sticky_token=q.sticky_token;var ca=new (c('URI'))('/probe').setDomain(q.fullHost+'.'+q.domain).setPort(q.port).setSecure(new (c('URI'))(window.location.href).isSecure()).setQueryData(ba),da=new (c('AjaxRequest'))('GET',ca);da.onJSON=function(ea,fa){if(ea&&ea.json&&ea.json.t==='heartbeat'){aa.push(Date.now());if(aa.length>=2){var ga=aa[1]-aa[0];if(ga>=q.PROBE_HEARTBEATS_INTERVAL_LOW&&ga<=q.PROBE_HEARTBEATS_INTERVAL_HIGH){q.streamingCapable=true;k.log('switch_to_streaming','{}');}}}};da.onSuccess=function(ea){if(aa.length!=2){q.streamingCapable=false;k.error('probe_error',JSON.stringify({error:'beats.length = '+aa.length}));}k.log('probe_success','{}');};da.onError=function(ea){q.streamingCapable=false;k.error('probe_error',JSON.stringify(ea));};da.send();},startChannelManager:function z(){if(c('ChannelInitialData').channelConfig){i.configure(c('ChannelInitialData').channelConfig);if(/shutdown/.test(c('ChannelInitialData').state))i._shutdownHint=c('ChannelConstants')[c('ChannelInitialData').reason];i.init(c('ChannelInitialData').state,c('ChannelInitialData').reason);c('ChatReliabilityInstrumentation').logCHANNEL_INIT();this.startChannelManager=c('emptyFunction');}else c('ChatReliabilityInstrumentation').logCHANNEL_NOCONFIG();}};f.exports=i;}),null);
__d('ChannelConnection',['Arbiter','ChannelConstants','ChannelManager','JSLogger','Run','SystemEvents','Visibility','setTimeoutAcrossTransitions'],(function a(b,c,d,e,f,g){var h=c('JSLogger').create('channel_connection'),i=null,j=null,k=null,l=null,m=0;c('ChannelManager').startChannelManager();var n=Object.assign(new (c('Arbiter'))(),{CONNECTED:'chat-connection/connected',RECONNECTING:'chat-connection/reconnecting',SHUTDOWN:'chat-connection/shutdown',MUTE_WARNING:'chat-connection/mute',UNMUTE_WARNING:'chat-connection/unmute'});c('Run').onBeforeUnload(function(){});function o(){if(j){clearTimeout(j);j=null;}}function p(){o();h.log('unmute_warning');n.inform(n.UNMUTE_WARNING);}function q(v){o();j=c('setTimeoutAcrossTransitions')(p,v);h.log('mute_warning',{time:v});n.inform(n.MUTE_WARNING);}function r(){if(k){clearTimeout(k);k=null;}}function s(v,w){r();if(v===c('ChannelConstants').ON_ENTER_STATE&&(w.nextState||w.state)==='pull'){if(l!==n.CONNECTED){h.log('connected');var x=!l;l=n.CONNECTED;m=0;n.inform(n.CONNECTED,{init:x});}}else if(v===c('ChannelConstants').ON_ENTER_STATE&&((w.nextState||w.state)==='ping'||!w.nextState&&w.state==='idle')){k=c('setTimeoutAcrossTransitions')(function(){var y=null;if(!(w.state==='idle'&&!w.nextState))y=w.delay||0;h.log('reconnecting',{delay:y});if(n.disconnected())h.log('reconnecting_ui',{delay:y});l=n.RECONNECTING;w.state==='idle'&&m++;if(m>1){n.inform(n.RECONNECTING,y);}else if(!w.nextState&&w.state==='idle')s(v,w);},500);}else if(v===c('ChannelConstants').ON_SHUTDOWN){h.log('shutdown',{reason:w.reason});l=n.SHUTDOWN;m=0;n.inform(n.SHUTDOWN,w.reason);}}function t(){if(c('ChannelManager').isShutdown()){s(c('ChannelConstants').ON_SHUTDOWN,c('ChannelManager')._shutdownHint);}else s(c('ChannelConstants').ON_ENTER_STATE,{state:c('ChannelManager').state,nextState:c('ChannelManager').nextState,delay:0});c('Visibility').addListener(c('Visibility').VISIBLE,n.reconnect);}c('Run').onAfterLoad(t);Object.assign(n,{disconnected:function v(){return l===n.SHUTDOWN||l===n.RECONNECTING&&!j&&m>1;},isShutdown:function v(){return l===n.SHUTDOWN;},reconnect:function v(w){if(c('ChannelManager').state==='ping'||c('ChannelManager').state==='pull'||c('ChannelManager').isShutdown())return;h.log('reconnect',{now:w});n.inform(n.RECONNECTING,0);if(!!w){if(i!==null){clearTimeout(i);i=null;}c('ChannelManager').enterState('ping!');}else if(!i)i=c('setTimeoutAcrossTransitions')(function(){c('ChannelManager').enterState('ping!');i=null;},c('ChannelConstants').CHANNEL_MANUAL_RECONNECT_DEFER_MSEC);c('ChannelManager').resetDelay();},unmuteWarning:p});function u(){c('Arbiter').subscribe([c('ChannelConstants').ON_ENTER_STATE,c('ChannelConstants').ON_SHUTDOWN],s);c('Arbiter').subscribe(c('ChannelConstants').ATTEMPT_RECONNECT,function(){if(n.disconnected())n.reconnect();});c('SystemEvents').subscribe(c('SystemEvents').TIME_TRAVEL,function(){n.reconnect();q(c('ChannelConstants').MUTE_WARNING_TIME_MSEC);});c('Run').onBeforeUnload(r,false);}c('Run').onAfterLoad(u);n.mockAfterLoad=function(){t();u();};c('Arbiter').subscribe(c('JSLogger').DUMP_EVENT,function(v,w){w.channel_connected=!n.disconnected();});f.exports=n;}),3);
__d('Dock',['csx','Event','shield','Arbiter','ArbiterMixin','BlueBar','ChatQuietLinks','CSS','DataStore','DOM','Parent','Scroll','Style','Toggler','Vector','emptyFunction'],(function a(b,c,d,e,f,g,h){function i(){}Object.assign(i,c('ArbiterMixin'),{MIN_HEIGHT:140,INITIAL_FLYOUT_HEIGHT_OFFSET:10,init:function j(k){this.init=c('emptyFunction');this.rootEl=k;this.calculateViewportDimensions();c('ChatQuietLinks').removeEmptyHrefs(this.rootEl);c('Event').listen(k,'click',this._onClick.bind(this));c('Event').listen(window,'resize',this._onWindowResize.bind(this));c('Toggler').subscribe(['show','hide'],function(l,m){var n=m.getActive();if(!c('DOM').contains(k,n))return;if(c('CSS').hasClass(n,'fbNub')){this.notifyNub(n,l);if(l==='show')this._resizeNubFlyout(n);}else{var o=c('Parent').byClass(n,'fbNubFlyout');if(o)c('CSS').conditionClass(o,'menuOpened',l==='show');}}.bind(this));this.inform('init',{},c('Arbiter').BEHAVIOR_PERSISTENT);},calculateViewportDimensions:function j(){return this.viewportDimensions=c('Vector').getViewportDimensions();},getFlyoutHeightOffset:function j(){if(this.flyoutHeightOffset)return this.flyoutHeightOffset;this.flyoutHeightOffset=this.INITIAL_FLYOUT_HEIGHT_OFFSET+c('Vector').getElementDimensions(this.rootEl).y;var k=c('BlueBar').getBar();if(k){var l=c('Style').isFixed(k)?'viewport':'document';this.flyoutHeightOffset+=c('Vector').getElementPosition(k,l).y+c('Vector').getElementDimensions(k).y;}return this.flyoutHeightOffset;},toggle:function j(k){var l=this._findFlyout(k);if(!l)return;this.subscribe('init',function(){c('Toggler').toggle(k);});},show:function j(k){this.subscribe('init',function(){c('Toggler').show(k);});},showNub:function j(k){c('CSS').show(k);},hide:function j(k){this.subscribe('init',function(){var l=c('Toggler').getInstance(k);c('DOM').contains(k,l.getActive())&&l.hide();});},hideNub:function j(k){c('CSS').hide(k);this.hide(k);},setUseMaxHeight:function j(k,l){c('CSS').conditionClass(k,'maxHeight',l!==false);this._resizeNubFlyout(k);},_resizeNubFlyout:function j(k){var l=this._findFlyout(k);if(!l||c('CSS').hasClass(k,'placeholder')||!(c('CSS').hasClass(k,'openToggler')||c('CSS').hasClass(k,'opened')))return;var m=c('DOM').find(l,'div.fbNubFlyoutOuter'),n=c('DOM').find(m,'div.fbNubFlyoutInner'),o=c('DOM').find(n,'div.fbNubFlyoutBody'),p=c('Scroll').getTop(o),q=o.offsetHeight;c('Style').set(o,'height','auto');var r=c('Vector').getElementDimensions(l),s=c('Vector').getElementDimensions(o),t=this.getMaxFlyoutHeight(k);c('Style').set(l,'max-height',t+'px');c('Style').set(m,'max-height',t+'px');r=c('Vector').getElementDimensions(l);var u=c('Vector').getElementDimensions(n),v=u.y-s.y,w=r.y-v,x=parseInt(o.style.height||o.clientHeight,10),y=w!==x;if(r.y>v&&y)c('Style').set(o,'height',w+'px');c('CSS').removeClass(l,'swapDirection');var z=c('Vector').getElementPosition(l).x;c('CSS').conditionClass(l,'swapDirection',function(){if(z<0)return true;if(!r||!this.viewportDimensions)return false;return z+r.x>this.viewportDimensions.x;}.bind(this)());if(y&&p+q>=s.y){c('Scroll').setTop(o,o.scrollHeight);}else c('Scroll').setTop(o,p);this.notifyNub(k,'resize');},getMaxFlyoutHeight:function j(k){var l=this._findFlyout(k),m=c('Vector').getElementPosition(l,'viewport'),n=c('Vector').getElementDimensions(l);if(!this.viewportDimensions||!m)return 0;var o=Math.max(this.MIN_HEIGHT,this.viewportDimensions.y-this.getFlyoutHeightOffset())-(this.viewportDimensions.y-m.y-n.y);return Math.max(o,0);},resizeAllFlyouts:function j(){var k=this._getAllNubs(),l=k.length;while(l--)this._resizeNubFlyout(k[l]);},hideAllFlyouts:function j(){var k=this._getAllNubs(),l=k.length;while(l--)this.hide(k[l]);},_getAllNubs:function j(){var k=c('DOM').scry(this.rootEl,"div._50-v.openToggler");return k.concat(c('DOM').scry(this.rootEl,"div._50-v.opened"));},_onClick:function j(event){var k=event.getTarget(),l=c('Parent').byClass(k,'fbNub');if(l){if(c('Parent').byClass(k,'fbNubFlyoutTitlebar')){var m=c('Parent').byTag(k,'a'),n=k.nodeName=='INPUT'&&k.getAttribute('type')=='submit';if(!m&&!n){this.hide(l);return false;}}this.notifyNub(l,'click');}},_onWindowResize:function j(event){this.calculateViewportDimensions();this.resizeAllFlyouts();},_findFlyout:function j(k){return c('CSS').hasClass(k,'fbNubFlyout')?k:c('DOM').scry(k,'div.fbNubFlyout')[0]||null;},registerNubController:function j(k,l){c('DataStore').set(k,'dock:nub:controller',l);l.subscribe('nub/button/content-changed',c('shield')(this.inform,this,'resize',k));l.subscribe('nub/flyout/content-changed',c('shield')(this._resizeNubFlyout,this,k));},unregisterNubController:function j(k){c('DataStore').remove(k,'dock:nub:controller');},notifyNub:function j(k,l,m){var n=c('DataStore').get(k,'dock:nub:controller');n&&n.inform(l,m);}});f.exports=b.Dock||i;}),null);
__d('MessengerSpinner.react',['cx','fbt','ix','Image.react','React','joinClasses'],(function a(b,c,d,e,f,g,h,i,j){'use strict';var k,l,m=c('React').PropTypes,n=j("86853"),o=j("86857"),p=j("86854"),q=24,r=32;k=babelHelpers.inherits(s,c('React').PureComponent);l=k&&k.prototype;s.prototype.render=function(){return c('React').createElement(c('Image.react'),{'aria-label':i._("Loading..."),'aria-busy':true,className:c('joinClasses')(this.props.className,"_3u55 _3qh2"),height:this.props.size,src:this.$MessengerSpinner1(),width:this.props.size});};s.prototype.$MessengerSpinner1=function(){return this.props.size===q?this.props.color==='blue'?n:o:p;};function s(){k.apply(this,arguments);}s.propTypes={color:m.oneOf(['blue','grey']),size:m.oneOf([q,r])};s.defaultProps={color:'blue',size:q};s.Sizes={LARGE:r,MEDIUM:q};f.exports=s;}),null);
__d('EmojiLikeConstants',['EmojiStaticConfig'],(function a(b,c,d,e,f,g){'use strict';var h=c('EmojiStaticConfig').sizeMap,i={XSMALL:'xsmall',SMALL:'small',MEDIUM:'medium',LARGE:'large'},j={dp16:'xsmall',dp32:'small',dp64:'medium',db64:'medium',dp128:'large'},k={PICKER:'picker',HOT_LIKE:'hot_like'},l=[983040],m='hot_emoji_source',n='hot_emoji_size',o='emoji_like',p='\uD83D\uDC4D',q=[128077];f.exports={FB_THUMBS_UP_EMOJI:l,size:i,sizeMap:h,sizeMapTransfer:j,source:k,SOURCE_TAG_PREFIX:m,TAG_PREFIX_NEW:n,TAG_PREFIX_OLD:o,THUMBS_UP_EMOJI:p,THUMBS_UP_EMOJI_CODES:q};}),null);
__d('MercuryAssert',['MercuryIDs'],(function a(b,c,d,e,f,g){f.exports={isParticipantID:function h(i){if(!c('MercuryIDs').isValid(i))throw new Error('bad_participant_id '+i);},allParticipantIDs:function h(i){i.forEach(this.isParticipantID);},isUserParticipantID:function h(i){var j=c('MercuryIDs').tokenize(i);if(j.type!='fbid')throw new Error('bad_user_id '+i);},isEmailParticipantID:function h(i){var j=c('MercuryIDs').tokenize(i);if(j.type!='email')throw new Error('bad_email_id '+i);},allThreadID:function h(i){i.forEach(this.isThreadID);},isThreadID:function h(i){if(!c('MercuryIDs').isValid(i))throw new Error('bad_thread_id '+i);}};}),null);
__d('MercurySingletonProvider',['CurrentUser'],(function a(b,c,d,e,f,g){'use strict';function h(i){this.$MercurySingletonProvider1={};this.$MercurySingletonProvider2=i;}h.prototype.getForFBID=function(i){if(!this.$MercurySingletonProvider1[i])this.$MercurySingletonProvider1[i]=new this.$MercurySingletonProvider2(i);return this.$MercurySingletonProvider1[i];};h.prototype.get=function(){return this.getForFBID(c('CurrentUser').getID());};h.mock=function(i){throw new Error('MercurySingletonProvider.mock() must only be used in tests.');};f.exports=h;}),null);
__d('MercuryThreadInformer',['ArbiterMixin','LogHistory','MercuryAssert','MercurySingletonProvider','mapObject','mixin'],(function a(b,c,d,e,f,g){'use strict';var h,i,j=c('LogHistory').getInstance('mercury_informer');h=babelHelpers.inherits(k,c('mixin')(c('ArbiterMixin')));i=h&&h.prototype;k.get=function(){return l.get();};k.getForFBID=function(m){return l.getForFBID(m);};function k(m){i.constructor.call(this);this.$MercuryThreadInformer1=m;this.$MercuryThreadInformer2={};this.$MercuryThreadInformer3={};this.$MercuryThreadInformer4={};this.$MercuryThreadInformer5={};this.$MercuryThreadInformer6=false;this.$MercuryThreadInformer7=false;this.$MercuryThreadInformer8=false;this.$MercuryThreadInformer9={};this.$MercuryThreadInformer10={};this.$MercuryThreadInformer11={};this.$MercuryThreadInformer12=0;}k.prototype.updatedThread=function(m){this.$MercuryThreadInformer3[m]=true;this.$MercuryThreadInformer13();};k.prototype.invalidatedThread=function(m){this.$MercuryThreadInformer4[m]=true;this.$MercuryThreadInformer13();};k.prototype.deletedThread=function(m){this.$MercuryThreadInformer2[m]=true;this.$MercuryThreadInformer13();};k.prototype.updatedThreadlist=function(){this.$MercuryThreadInformer6=true;this.$MercuryThreadInformer13();};k.prototype.updatedUnseenState=function(){this.$MercuryThreadInformer7=true;this.$MercuryThreadInformer13();};k.prototype.updatedUnreadState=function(){this.$MercuryThreadInformer8=true;this.$MercuryThreadInformer13();};k.prototype.changedThreadReadState=function(m,n,o){if(!this.$MercuryThreadInformer5[m]||this.$MercuryThreadInformer5[m].timestamp<o)this.$MercuryThreadInformer5[m]={mark_as_read:n,timestamp:o};this.$MercuryThreadInformer13();};k.prototype.receivedMessage=function(m){c('MercuryAssert').isThreadID(m.thread_id);var n=m.thread_id;if(!this.$MercuryThreadInformer9[n])this.$MercuryThreadInformer9[n]=[];this.$MercuryThreadInformer9[n].push(m);this.updatedThread(n);};k.prototype.reorderedMessages=function(m,n){this.$MercuryThreadInformer10[m]={source:n};this.$MercuryThreadInformer13();};k.prototype.updatedMessage=function(m,n,o){if(!this.$MercuryThreadInformer11[m])this.$MercuryThreadInformer11[m]={};this.$MercuryThreadInformer11[m][n]={source:o};this.updatedThread(m);};k.prototype.synchronizeInforms=function(m){this.$MercuryThreadInformer12++;try{m();}catch(n){throw n;}finally{this.$MercuryThreadInformer12--;this.$MercuryThreadInformer13();}};k.prototype.listen=function(m,n){return this.subscribe('threads-updated',function(o,p){if(p[m])n(m);});};k.prototype.$MercuryThreadInformer13=function(){if(!this.$MercuryThreadInformer12){var m=this.$MercuryThreadInformer2,n=this.$MercuryThreadInformer3,o=this.$MercuryThreadInformer4,p=this.$MercuryThreadInformer5,q=this.$MercuryThreadInformer6,r=this.$MercuryThreadInformer7,s=this.$MercuryThreadInformer8,t=this.$MercuryThreadInformer9,u=this.$MercuryThreadInformer10,v=this.$MercuryThreadInformer11;this.$MercuryThreadInformer2={};this.$MercuryThreadInformer3={};this.$MercuryThreadInformer4={};this.$MercuryThreadInformer5={};this.$MercuryThreadInformer6=false;this.$MercuryThreadInformer7=false;this.$MercuryThreadInformer8=false;this.$MercuryThreadInformer9={};this.$MercuryThreadInformer10={};this.$MercuryThreadInformer11={};var w=Object.keys(n);if(w.length||q)this.inform('threadlist-updated',w);if(w.length)this.$MercuryThreadInformer14('threads-updated',n);for(var x in o){this.$MercuryThreadInformer14('thread-invalidated',o);break;}for(var x in p){this.$MercuryThreadInformer14('thread-read-changed',p);break;}for(x in m){this.$MercuryThreadInformer14('threads-deleted',m);break;}if(r)this.$MercuryThreadInformer14('unseen-updated',null);if(s)this.$MercuryThreadInformer14('unread-updated',null);for(x in t){this.$MercuryThreadInformer14('messages-received',t);break;}for(x in u){this.$MercuryThreadInformer14('messages-reordered',u);break;}for(x in v){this.$MercuryThreadInformer14('messages-updated',v);break;}}};k.prototype.$MercuryThreadInformer14=function(m,n){if(m==='threads-updated')j.debug(m,JSON.stringify(n));this.inform(m,n);};var l=new (c('MercurySingletonProvider'))(k);f.exports=k;}),null);
__d('MercuryViewer',['CurrentUser','MercuryAssert'],(function a(b,c,d,e,f,g){'use strict';var h='fbid:'+c('CurrentUser').getID(),i={getID:function j(){return h;},isViewer:function j(k){c('MercuryAssert').isParticipantID(k);return k===h;}};f.exports=i;}),null);
__d('SoundPlayer',['URI','createArrayFromMixed','Map'],(function a(b,c,d,e,f,g){'use strict';var h=new (c('Map'))();function i(l){var m=new (c('URI'))(l);return m.getDomain()?l:new (c('URI'))(window.location.href).setPath(m.getPath()).toString();}function j(l){var m=new (c('URI'))(l).getPath();if(/\.mp3$/.test(m))return 'audio/mpeg';if(/\.og[ga]$/.test(m))return 'audio/ogg';return '';}var k={preload:function l(m){for(var n=c('createArrayFromMixed')(m),o=Array.isArray(n),p=0,n=o?n:n[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var q;if(o){if(p>=n.length)break;q=n[p++];}else{p=n.next();if(p.done)break;q=p.value;}var r=q;if(h.has(r))return;var s=document.createElement('audio');if(!s||!s.canPlayType||!s.canPlayType(j(r)))continue;s.preload='auto';s.src=i(r);document.body&&document.body.appendChild(s);h.set(r,s);return;}},play:function l(m){var n=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];for(var o=c('createArrayFromMixed')(m),p=Array.isArray(o),q=0,o=p?o:o[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var r;if(p){if(q>=o.length)break;r=o[q++];}else{q=o.next();if(q.done)break;r=q.value;}var s=r;if(!h.has(s))k.preload(s);var t=h.get(s);if(!t)continue;if(n.loop)t.setAttribute('loop','');if(n.volume)t.volume=n.volume;t.play();return;}},pause:function l(m){for(var n=c('createArrayFromMixed')(m),o=Array.isArray(n),p=0,n=o?n:n[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var q;if(o){if(p>=n.length)break;q=n[p++];}else{p=n.next();if(p.done)break;q=p.value;}var r=q,s=h.get(r);if(s){s.pause();return;}}},stop:function l(m){for(var n=c('createArrayFromMixed')(m),o=Array.isArray(n),p=0,n=o?n:n[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var q;if(o){if(p>=n.length)break;q=n[p++];}else{p=n.next();if(p.done)break;q=p.value;}var r=q,s=h.get(r);if(s){s.pause();s.removeAttribute('src');s.src=i(r);return;}}}};f.exports=k;}),null);
__d('SoundSynchronizer',['SoundPlayer','WebStorage','createArrayFromMixed'],(function a(b,c,d,e,f,g){var h='fb_sounds_playing3';function i(){var m=c('WebStorage').getLocalStorage();if(m)try{var n=m[h];if(n){n=JSON.parse(n);if(Array.isArray(n))return n;}}catch(o){}return [];}function j(m){var n=c('WebStorage').getLocalStorage();if(n){var o=i();o.push(m);while(o.length>5)o.shift();try{n[h]=JSON.stringify(o);}catch(p){}}}function k(m){return i().some(function(n){return n===m;});}var l={play:function m(n,o,p){n=c('createArrayFromMixed')(n);o=o||n[0]+Math.floor(Date.now()/1000);if(k(o))return;c('SoundPlayer').play(n,{loop:!!p});j(o);},isSupported:function m(){return !!c('WebStorage').getLocalStorage();}};f.exports=l;}),null);
__d('SoundRPC',['Event','FBJSON','SoundSynchronizer'],(function a(b,c,d,e,f,g){function h(j,k,l){c('SoundSynchronizer').play(j,k,l);}var i={playLocal:h,playRemote:function j(k,l,m,n){var o={name:'SoundRPC',data:{paths:l,sync:m,loop:n}};k.postMessage(c('FBJSON').stringify(o),'*');},supportsRPC:function j(){return !!window.postMessage;},_listen:function j(){c('Event').listen(window,'message',function(k){if(!/\.facebook.com$/.test(k.origin))return;var l={};try{l=c('FBJSON').parse(k.data);}catch(m){}if(l.name==='SoundRPC')h(l.data.paths,l.data.sync,l.data.loop);});}};f.exports=i;}),null);
__d('Sound',['SoundInitialData','SoundPlayer','SoundRPC','SoundSynchronizer','URI','UserAgent_DEPRECATED','Visibility','isFacebookURI'],(function a(b,c,d,e,f,g){var h=null,i=false,j={init:function n(o){},play:function n(o,p,q){if(h){c('SoundRPC').playRemote(h.contentWindow,o,p,false);}else c('SoundRPC').playLocal(o,p,q);i=true;},hasPlayedSoundBefore:function n(){return i;},playOnlyIfImmediate:function n(o,p,q){if(!i&&c('Visibility').isHidden())return;this.play(o,p,q);},stop:function n(o){if(!h)c('SoundPlayer').stop(o);}},k=new (c('URI'))(location.href);if(k.getSubdomain()&&k.getSubdomain()!=='www')k.setSubdomain('www');var l=k.getDomain();function m(){if(c('UserAgent_DEPRECATED').ie()<9)return false;if(c('SoundInitialData').RPC_DISABLED)return false;return c('SoundSynchronizer').isSupported()&&c('SoundRPC').supportsRPC();}if(c('isFacebookURI')(k)&&location.host!==l&&m()){h=document.createElement('iframe');h.setAttribute('src','//'+l+'/sound_iframe.php');h.style.display='none';document.body.appendChild(h);}f.exports=j;}),null);
__d('P2PActionConstants',[],(function a(b,c,d,e,f,g){'use strict';var h={CREDIT_CARDS_UPDATED:'credit_cards_updated',CREDIT_CARDS_UPDATED_ERROR:'credit_cards_updated_error',CHANNEL_EVENTS_ALLOWED:'channel_events_allowed',CHANNEL_EVENTS_IGNORED:'channel_events_ignored',CREDIT_CARD_SAVING:'credit_card_saving',CREDIT_CARD_ADDED:'credit_card_added',CREDIT_CARD_ADDED_ERROR:'credit_card_added_error',CREDIT_CARD_ADDED_ERROR_CLEARED:'credit_card_added_error_cleared',CREDIT_CARD_DELETED:'credit_card_deleted',CREDIT_CARD_DELETED_ERROR:'credit_card_deleted_error',CREDIT_CARD_UPDATED:'credit_card_updated',CREDIT_CARD_UPDATED_ERROR:'credit_card_updated_error',PRESET_CREDIT_CARD_UPDATED:'preset_credit_card_updated',PRESET_CREDIT_CARD_UPDATED_ERROR:'preset_credit_card_updated_error',CREDIT_CARD_VERIFIED:'credit_card_verified',CREDIT_CARD_VERIFIED_ERROR:'credit_card_verified_error',PAYMENT_METHODS_UPDATED:'payment_methods_updated',PAYMENT_METHODS_UPDATED_ERROR:'payment_methods_updated_error',TRANSFERS_UPDATED:'transfers_updated',TRANSFERS_UPDATED_ERROR:'transfers_updated_error',NUX_TRANSFERS_UPDATED:'nux_transfers_updated',TRANSFER_ADDED:'transfer_added',TRANSFER_ADDED_ERROR:'transfer_added_error',TRANSFER_UPDATED:'transfer_updated',TRANSFER_UPDATED_ERROR:'transfer_updated_error',TRANSFER_ACCEPTED:'transfer_accepted',TRANSFER_DECLINED:'transfer_declined',CHAT_SEND_VIEW_OPENED:'chat_send_view_opened',CHAT_SEND_VIEW_CLOSED:'chat_send_view_closed',BIN_NUMBER_VALIDATED:'bin_number_validated',BIN_NUMBER_VALIDATED_ERROR:'bin_number_validated_error',USER_ELIGIBILITY_UDPATED:'user_eligibility_updated',FRIENDS_LIST_UPDATED:'friends_list_updated',DIALOG_SHOWN:'dialog_shown',DIALOG_CLOSED:'dialog_closed',BANNER_STATES_UPDATED:'banner_states_updated',BANNER_DISMISSED:'banner_dismissed',BANNER_VIEWED:'banner_viewed',BANNER_COMPLETED:'banner_completed',MONEYPENNY_TRANSFER_CREATED:'moneypenny_transfer_created',MONEYPENNY_TRANSFER_CREATED_ERROR:'moneypenny_transfer_created_error',PLATFORM_CONTEXT_ADDED:'platform_context_added',PLATFORM_CONTEXT_ADDED_ERROR:'platform_context_added_error',PLATFORM_CONTEXT_SAVE_ERRORS_CLEARED:'platform_context_save_errors_cleared',PLATFORM_CONTEXT_BANNER_DISMISSED:'platform_context_banner_dismissed',PLATFORM_CONTEXT_PRODUCT_ITEM_SOLD:'platform_context_product_item_sold',PLATFORM_CONTEXT_CHANGED:'platform_context_changed',EXTENSIVE_TRANSFER_DETAILS_UPDATED:'extensive_transfer_details_updated',ADDRESS_SAVING:'address_saving',ADDRESSES_UPDATED:'addresses_updated',ADDRESS_ADDED:'address_added',ADDRESS_ADDED_ERROR:'address_added_error',ADDRESS_ADDED_ERROR_CLEARED:'address_added_error_cleared',CHECKOUT_CART_INITIATED:'checkout_cart_initiated',CHECKOUT_CART_CREATED:'checkout_cart_created',CHECKOUT_SHIPPING_OPTION_SELECTED:'checkout_shipping_option_selected',CHECKOUT_ADDRESS_SELECTED:'checkout_address_selected',CHECKOUT_CREDIT_CARD_SELECTED:'checkout_credit_card_selected',CHECKOUT_ADDRESS_FORM_TOGGLED:'checkout_address_form_toggled',CHECKOUT_CREDIT_CARD_FORM_TOGGLED:'checkout_credit_card_form_toggled',CHECKOUT_ADDRESS_EDIT_OPTIONS_TOGGLED:'checkout_address_options_toggled',CHECKOUT_CREDIT_CARD_EDIT_OPTIONS_TOGGLED:'checkout_credit_card_edit_options_toggled',CHECKOUT_PAYMENT_METHOD_EDIT_OPTIONS_TOGGLED:'checkout_payment_edit_options_toggled',CHECKOUT_PAYMENT_METHOD_SELECTED:'checkout_payment_method_selected',CHECKOUT_PAYMENT_METHOD_CONFIGURED:'checkout_payment_method_configured',CHECKOUT_PAYMENT_METHOD_CONFIRMED:'checkout_payment_method_confirmed',CHECKOUT_ADDRESS_FORM_VALIDATED:'checkout_address_form_validated',CHECKOUT_CREDIT_CARD_FORM_VALIDATED:'checkout_credit_card_form_validated',CHECKOUT_EDIT_COMPLETED:'checkout_completed',CHECKOUT_PROCESSING:'checkout_processing',CHECKOUT_BUYER_PROFILE_UPDATED:'checkout_buyer_profile_updated',CHECKOUT_MANUAL_PAYMENT_RECEIPT_UPDATED:'checkout_manual_payment_receipt_updated',PAYMENT_REQUEST_INITIATED:'payment_request_initiated',PAYMENT_REQUEST_INITIATED_COMPLETE:'payment_request_initiated_completed',PAYMENT_REQUEST_CREATED:'payment_request_created',PAYMENT_REQUEST_CREATED_ERROR:'payment_request_created_error',PAYMENT_REQUEST_UPDATED:'payment_request_updated',PAYMENT_REQUEST_DECLINE_INITIATED:'payment_request_decline_initiated',PAYMENT_REQUEST_DECLINED:'payment_request_declined',PAYMENT_REQUEST_DECLINE_ERROR:'payment_request_decline_error',PAYMENT_REQUESTS_FETCHED:'payment_requests_fetched',PAYMENT_REQUEST_CANCEL_INITIATED:'payment_request_cancel_initiated',PAYMENT_REQUEST_CANCELED:'payment_request_canceled',PAYMENT_REQUEST_CANCEL_ERROR:'payment_request_cancel_error'};f.exports=h;}),null);
__d('P2PDispatcher',['ExplicitRegistrationReactDispatcher'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('ExplicitRegistrationReactDispatcher'));i=h&&h.prototype;function j(k){i.constructor.call(this,k);this.dispatch=this.dispatch.bind(this);}f.exports=new j({strict:false});}),null);
__d('PureStoreBasedStateMixin',['invariant','StoreBasedStateMixinHelper','setImmediate'],(function a(b,c,d,e,f,g,h){'use strict';var i=function(){for(var j=arguments.length,k=Array(j),l=0;l<j;l++)k[l]=arguments[l];return {getInitialState:function m(){return this.constructor.calculateState();},componentWillMount:function m(){this.constructor.calculateState||h(0);this._recalculateStateID=null;var n=function(){if(this.isMounted())this.setState(this.constructor.calculateState());this._recalculateStateID=null;}.bind(this);this._mixin=new (c('StoreBasedStateMixinHelper'))(k);this._mixin.subscribeCallback(function(){if(this._recalculateStateID===null)this._recalculateStateID=c('setImmediate')(n);}.bind(this));},componentWillUnmount:function m(){this._mixin.release();this._mixin=null;}};}.bind(this);f.exports=i;}),null);
__d('FBPaymentsDispatcher',['ExplicitRegistrationReactDispatcher'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('ExplicitRegistrationReactDispatcher'));i=h&&h.prototype;function j(k){i.constructor.call(this,k);this.dispatch=this.dispatch.bind(this);}f.exports=new j({strict:false});}),null);
__d('FBPaymentsDialogActions',['FBPaymentsDispatcher','keyMirror'],(function a(b,c,d,e,f,g){'use strict';var h={types:c('keyMirror')({SHOW_DIALOG:null,HIDE_DIALOG:null}),showDialog:function i(j,k){c('FBPaymentsDispatcher').dispatch({type:h.types.SHOW_DIALOG,data:{dialogClass:j,dialogProps:k}});},hideDialog:function i(){c('FBPaymentsDispatcher').dispatch({type:h.types.HIDE_DIALOG,data:{}});}};f.exports=h;}),null);
__d('MercuryTimestamp',['fbt','formatDate','MercuryTimePassed'],(function a(b,c,d,e,f,g,h){var i=86400000,j=6*i,k={getFormatedTimestamp:function l(m){var n=m/1000;return k.getFormattedTimestampByBucket(n,this.getTimeBucket(m));},getAbsoluteTimestamp:function l(m){if(m==null){return null;}else{var n=k.getFormatedTimestamp(m);return n.absolute;}},getRelativeTimestamp:function l(m){var n=k.getFormatedTimestamp(m);return n.relative;},getFormattedTimestampByBucket:function l(m,n){switch(n){case c('MercuryTimePassed').TODAY:return {absolute:h._("Today"),relative:c('formatDate')(m,'g:ia')};case c('MercuryTimePassed').WEEK_AGO:return {absolute:c('formatDate')(m,'l'),relative:c('formatDate')(m,'D')};case c('MercuryTimePassed').CURRENT_YEAR:return {absolute:c('formatDate')(m,'F j'),relative:c('formatDate')(m,'M j')};default:return {absolute:c('formatDate')(m,'F j, Y'),relative:c('formatDate')(m,'n/j/y')};}},getTimeBucket:function l(m){var n=new Date(m),o=new Date(),p=new Date(o.getFullYear(),o.getMonth(),o.getDate());if(p<n){return c('MercuryTimePassed').TODAY;}else if(p-j<n){return c('MercuryTimePassed').WEEK_AGO;}else if(p.getFullYear()===n.getFullYear()){return c('MercuryTimePassed').CURRENT_YEAR;}else return c('MercuryTimePassed').OTHER_YEAR;},getPreciseTimestamp:function l(m){return c('formatDate')(new Date(m),k.getPreciseFormat(m));},getPreciseFormat:function l(m){var n=k.getTimeBucket(m);switch(n){case c('MercuryTimePassed').TODAY:return 'g:ia';case c('MercuryTimePassed').WEEK_AGO:return 'l g:ia';case c('MercuryTimePassed').CURRENT_YEAR:return 'F jS, g:ia';case c('MercuryTimePassed').OTHER_YEAR:default:return 'F j, Y g:i a';}}};f.exports=k;}),null);